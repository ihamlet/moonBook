(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9bcd4510"],{"0857":function(t,a,e){"use strict";e("a0e0");var s=e("a013"),i=e("f425"),n=e("dad2"),o="toString",c=/./[o],r=function(t){e("e5ef")(RegExp.prototype,o,t,!0)};e("b6f1")(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?r(function(){var t=s(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?i.call(t):void 0)}):c.name!=o&&r(function(){return c.call(this)})},"0a0f":function(t,a,e){},"2d0f":function(t,a,e){},"2ec8":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"card",on:{click:function(a){return t.toBookDetails(t.item)}}},[e("div",{staticClass:"item flex flex-align"},[e("div",{staticClass:"book-cover"},[e("img",{attrs:{src:t.thumb(t.item.book_photo)}})]),e("div",{staticClass:"book-info"},[e("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:2,expression:"2",arg:"20"}],staticClass:"title"},[t._v(t._s(t.item.book_name))]),e("div",{staticClass:"time"},[t._v("打卡时间："+t._s(t.getTime(t.item.create_time)))])]),t.item.book_id>0?e("div",{staticClass:"iconfont"},[t._v("\n        \n      ")]):t._e()])])},i=[],n=(e("3c6b"),e("bec1")),o={name:"card-punch",props:["item"],methods:{thumb:function(t){if(t){var a=t.match(/https?:\/\/(.+?)\//);return a?"/book/api/remotePic?url=".concat(t):t}},toBookDetails:function(t){t.book_id>0&&this.$router.push({name:"book-details",query:{id:t.book_id}})},getTime:function(t){return Object(n["e"])(1e3*t,"HH:mm:ss")}}},c=o,r=(e("c175"),e("17cc")),l=Object(r["a"])(c,s,i,!1,null,"b45906b6",null);a["a"]=l.exports},"3a2f":function(t,a,e){},"4ec5":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"punch-list page-padding"},[e("div",{staticClass:"booth"},[e("div",{staticClass:"ad-mould"},[e("van-swipe",{attrs:{autoplay:3e3,"indicator-color":"white",height:120}},t._l(t.banner,function(a,s){return e("van-swipe-item",{key:s,on:{click:function(e){return t.toAdvertising(a)}}},[e("div",{staticClass:"card-banner"},[e("img",{attrs:{src:a.photo}})])])}),1)],1)]),e("div",{staticClass:"punch-data"},[e("van-nav-bar",{attrs:{border:!1,title:"阅读打卡"},on:{"click-right":t.onClickShare}},[e("div",{staticClass:"share-right theme-color",attrs:{slot:"right"},slot:"right"},[t._v("\n        分享"),e("i",{staticClass:"iconfont"},[t._v("")])])]),e("van-cell",[e("div",{staticClass:"flex flex-align"},[e("div",{staticClass:"item-data item-today-num"},[e("div",{staticClass:"sub"},[t._v("实时打卡")]),e("div",{staticClass:"people-number"},t._l(t.numberOfPeople,function(a,s){return e("span",{key:s,staticClass:"num"},[t._v(t._s(a))])}),0),e("i",{staticClass:"iconfont"},[t._v("")])]),e("div",{staticClass:"item-data item-grade"},[e("div",{staticClass:"sub"},[t._v("我的成绩")]),e("div",{staticClass:"item-box my-data flex"},[e("div",{staticClass:"num-number"},[e("span",{staticClass:"i-sub"},[t._v("打卡:")]),e("span",[t._v(t._s(t.$route.query.sign_read_count)+"本")])]),e("div",{staticClass:"day-number"},[e("span",{staticClass:"i-sub"},[t._v("坚持:")]),e("span",[t._v(t._s(t.$route.query.sign_days)+"天")])])]),e("i",{staticClass:"iconfont"},[t._v("")])]),e("div",{staticClass:"item-data item-ability"},[e("div",{staticClass:"sub"},[t._v("学习力")]),e("div",{staticClass:"item-box"},[t._v("超过 "),e("span",{staticClass:"percentage"},[t._v(t._s(t.childInfo.ahead_percent)+"%")]),t._v(" 的同学")]),e("i",{staticClass:"iconfont"},[t._v("")])])])])],1),e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[e("van-nav-bar",{attrs:{border:!1,"right-text":"我的进度"},on:{"click-right":t.onClickRight}},[e("div",{staticClass:"date-title",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.day))])]),e("van-list",{attrs:{finished:t.finished,"finished-text":t.$store.state.slogan},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[t.list.length?e("div",{staticClass:"list"},t._l(t.list,function(t,a){return e("van-cell",{key:a,attrs:{"is-link":t.book_id>0,center:""}},[e("cardPunch",{attrs:{item:t}})],1)}),1):e("div",{staticClass:"no-list"},[t._v("\n        尚无打卡图书\n      ")])])],1),e("van-popup",{staticClass:"popup-release",attrs:{position:"bottom","get-container":"#app"},model:{value:t.releaseShow,callback:function(a){t.releaseShow=a},expression:"releaseShow"}},[e("videoList")],1),e("div",{staticClass:"footer-bar flex"},[e("div",{staticClass:"btn-box"},[e("van-button",{staticClass:"btn theme-btn",attrs:{type:"primary",round:"",size:"normal"},on:{click:function(a){return t.setReleaseSwitch(!0)}}},[t._v("晒一晒")])],1),e("div",{staticClass:"btn-box"},[e("van-button",{staticClass:"btn theme-borrowing-btn",attrs:{round:"",type:"primary",size:"normal"},on:{click:t.toSpecialPunch}},[t._v("看一看")])],1)]),e("div",{staticClass:"release-footer-bar"},[e("van-popup",{staticClass:"tips-popup",attrs:{overlayStyle:{backgroundColor:"transparent"},"get-container":".footer-bar","lock-scroll":!1},model:{value:t.showTips,callback:function(a){t.showTips=a},expression:"showTips"}},[e("tips",{attrs:{isShow:t.showTips,iconLength:"2",position:"bottom",bookId:t.extra.book_id},on:{close:function(a){return t.setReleaseSwitch(!1)}}})],1)],1),e("van-popup",{staticClass:"animate-popup",attrs:{"close-on-click-overlay":!1},model:{value:t.animateShow,callback:function(a){t.animateShow=a},expression:"animateShow"}},[e("van-icon",{staticClass:"close-icon",attrs:{name:"close"},on:{click:function(a){t.animateShow=!1}}}),e("trophy",{attrs:{signDays:t.$route.query.sign_days}}),e("div",{staticClass:"share flex flex-justify"},[e("van-button",{staticClass:"share-btn theme-plain",attrs:{round:"",plain:"",type:"primary"},on:{click:t.onClickRight}},[t._v("领取奖品")])],1)],1)],1)},i=[],n=(e("3c6b"),e("f763"),e("0857"),e("7bc1"),e("e20c")),o=e("9993"),c=e("591a"),r=e("2ec8"),l=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"video-list"},[e("van-swipe",{attrs:{"show-indicators":!1},on:{change:t.onChange}},t._l(t.videoList,function(t,a){return e("van-swipe-item",{key:a},[e("div",{staticClass:"video-box"},[e("div",{staticClass:"video-container",class:"video-"+a})])])}),1)],1)},u=[],d={name:"video-list",computed:{},data:function(){return{videoObject:{variable:"player",loaded:"loadedHandler",loop:!1,config:"",debug:!0,drag:"start",seek:0,video:[]},current:0,videoList:[{url:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/1",cover:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/1?x-oss-process=video/snapshot,t_10000,m_fast"},{url:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/3",cover:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/3?x-oss-process=video/snapshot,t_10000,m_fast"},{url:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/4",cover:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/4?x-oss-process=video/snapshot,t_10000,m_fast"},{url:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/5",cover:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/5?x-oss-process=video/snapshot,t_10000,m_fast"},{url:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/6",cover:"https://activity-video.oss-cn-shanghai.aliyuncs.com/video/6?x-oss-process=video/snapshot,t_10000,m_fast"}]}},mounted:function(){var t=this;this.$nextTick(function(){t.player.videoPlay()})},methods:{onChange:function(t){this.current=t,console.log(this.player),this.player.playOrPause()}}},h=d,v=(e("828a"),e("17cc")),p=Object(v["a"])(h,l,u,!1,null,"90f19cae",null),f=p.exports,m=e("bec1"),b=e("0606"),g=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"trophy-box"},[e("div",{staticClass:"poset flex flex-justify"},[e("div",{staticClass:"arctext bounceIn animated an-2"},t._l(t.arctext,function(a,s){return e("span",{key:s,class:["route-"+s,a.name],attrs:{"data-text":a.text}},[t._v(t._s(a.text))])}),0),e("img",{staticClass:"trophy bounceIn animated an-0",attrs:{src:"https://assets-moonbook.oss-cn-beijing.aliyuncs.com/animate/jiangbei%20.png"}}),e("div",{staticClass:"receive tada animated an-4"},[t._v("\n            领奖啦!\n        ")])])])},_=[],y={name:"Trophy",props:["signDays"],computed:{arctext:function(){var t=[{name:"text",text:"已"},{name:"text",text:"完"},{name:"text",text:"成"},{name:"number",text:this.signDays},{name:"text",text:"天"},{name:"text",text:"打"},{name:"text",text:"卡"}];return t}}},C=y,k=(e("ba93"),Object(v["a"])(C,g,_,!1,null,"6daf1708",null)),x=k.exports,w={name:"punchBack",components:{cardPunch:r["a"],videoList:f,tips:b["a"],trophy:x},computed:Object(n["a"])({},Object(c["c"])(["userDataState"]),Object(c["e"])(["releaseSwitch"]),{showTips:{get:function(){return this.releaseSwitch},set:function(t){this.setReleaseSwitch(t)}},numberOfPeople:function(){return this.punchNumber.toString().split("")}}),data:function(){return{timer:null,loading:!1,finished:!1,list:[],bookInfo:"",page:1,day:"",show:!1,punchNumber:4950,count:5e3,interval:50,animateShow:!1,releaseShow:!1,releaseType:[{icon:"icon-weibo",text:"发图文",index:0},{icon:"icon-paishipin",text:"拍小视频",index:1}],banner:[],extra:"",childInfo:""}},created:function(){this.fetchData()},watch:{$router:"fetchData"},beforeDestroy:function(){clearInterval(this.timer)},methods:Object(n["a"])({},Object(c["d"])(["setReleaseSwitch"]),{fetchData:function(){var t=this,a={params:{site_name:"打卡阅读",school_id:this.userDataState.teacher_school_id>0?this.userDataState.teacher_school_id:this.userDataState.school_id}};o["a"].get("/book/api/ads",a).then(function(a){switch(a.data.status){case 1:a.data.data.forEach(function(a){null!=a.photo&&t.banner.push(a)});break}}),o["a"].get("/book/baby/getInfo",{params:{child_id:this.$route.query.child_id}}).then(function(a){switch(a.data.status){case 1:t.childInfo=a.data.data;break}}),14==this.$route.query.sign_days&&(this.animateShow=!0),this.getReadSignCount(),this.timer=setInterval(this.setCount,3e3)},getReadSignCount:function(){var t=this;o["a"].get("/book/member/read_sign_stat").then(function(a){switch(a.data.status){case 1:t.count=a.data.data.count,t.punchNumber=a.data.data.count-t.interval;break}})},setCount:function(){this.punchNumber<this.count?this.punchNumber+=Math.floor(5*Math.random()+1):this.punchNumber},onLoad:function(){var t=this;this.day=Object(m["e"])(new Date,"yyyy-MM-dd");var a={params:{page:this.page,child_id:this.$route.query.child_id,create_date_min:this.day}};return o["a"].get("/book/member/get_read_sign_list",a).then(function(a){switch(a.data.status){case 1:t.extra=Object(n["a"])({book_id:0},a.data.data[0]),1==t.page?t.list=a.data.data:t.list=t.list.concat(a.data.data),t.loading=!1,t.page++,t.list.length>=a.data.count&&(t.finished=!0);break;case 0:t.page=1,t.loading=!1,t.finished=!0,t.list=[];break}})},onRefresh:function(){var t=this;this.page=1,this.onLoad().then(function(){t.loading=!1,t.finished=!1})},comeBack:function(){this.$router.push({name:this.$route.query.back,query:{id:this.$route.query.id}})},thumb:function(t){if(t){var a=t.match(/https?:\/\/(.+?)\//);return a?"/book/api/remotePic?url=".concat(t):t}},toAdvertising:function(t){t.link_url&&null!=t.link_url&&this.$router.push(t.link_url)},toSpecialPunch:function(){this.$router.push({name:"specialPunch",query:Object(n["a"])({},this.$route.query,{cate_id:this.$route.query.cate_id,tags:this.$route.query.tags,book_id:this.extra.book_id})})},onClickRight:function(){this.$router.push({name:"punchSpeed"})},onClickShare:function(){this.$router.push({name:"punch-share",query:Object(n["a"])({},this.extra,{day:this.day})})}})},S=w,$=(e("888f"),Object(v["a"])(S,s,i,!1,null,"9ce43488",null));a["default"]=$.exports},"716e":function(t,a,e){},"828a":function(t,a,e){"use strict";var s=e("716e"),i=e.n(s);i.a},"888f":function(t,a,e){"use strict";var s=e("2d0f"),i=e.n(s);i.a},a0e0:function(t,a,e){e("dad2")&&"g"!=/./g.flags&&e("ddf7").f(RegExp.prototype,"flags",{configurable:!0,get:e("f425")})},ba93:function(t,a,e){"use strict";var s=e("0a0f"),i=e.n(s);i.a},c175:function(t,a,e){"use strict";var s=e("3a2f"),i=e.n(s);i.a}}]);