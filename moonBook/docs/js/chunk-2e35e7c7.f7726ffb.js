(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e35e7c7"],{"972c":function(t,e,a){},aa48:function(t,e,a){"use strict";var i=a("972c"),o=a.n(i);o.a},b4bd:function(t,e,a){"use strict";a.d(e,"a",function(){return i}),a.d(e,"b",function(){return o}),a.d(e,"c",function(){return r}),a.d(e,"d",function(){return n});var i=["省级示范","市级示范","市一级","市二级","市三级","示范园","一类园","二类园","普通园"],o=["民办学校","公办学校","私立学校","国际学校"],r=["1000以上","900-1000人","800-900人","700-800人","600-700人","500-600人","400-500人","300-400人","200-300人","100-200人","50-100人"],n=["班主任","带班老师","生活老师"]},eb30:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"teacher-edit page-padding"},[a("van-nav-bar",{attrs:{title:t.$route.query.title,border:!1},on:{"click-right":t.past}},[0==t.form.is_master&&"edit"==t.$route.query.type?a("div",{staticClass:"is-confim",style:{color:1==t.isConfirm?"#F56C6C":"#67C23A"},attrs:{slot:"right"},slot:"right"},[t._v("\n      "+t._s(0==t.isConfirm?"通过":"请出")+"\n    ")]):t._e()]),a("div",{staticClass:"container"},[a("van-cell-group",[a("van-field",{attrs:{size:"large",border:!1,readonly:"edit"==t.pageType,"input-align":"right",required:"edit"!=t.pageType,label:"姓名",placeholder:"请输入用户姓名"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}}),a("van-field",{attrs:{size:"large",border:!1,readonly:"edit"==t.pageType,"input-align":"right",required:"edit"!=t.pageType,label:"手机号",placeholder:"请输入手机号"},model:{value:t.form.mobile,callback:function(e){t.$set(t.form,"mobile",e)},expression:"form.mobile"}})],1),a("van-cell-group",{attrs:{border:!1}},[a("van-cell",{attrs:{title:"班级",border:!1,value:t.form.banji_name?t.formatBanjiTitle(t.form.banji_name):"请设置班级","is-link":""},on:{click:t.toSelectBanjiPage}}),a("van-cell",{attrs:{title:"职务",border:!1,value:t.form.duty,"is-link":"","arrow-direction":t.show?"up":"down"},on:{click:t.pickerShow}})],1),0!=t.form.role_id?a("van-panel",{attrs:{title:"角色设置",desc:"对应角色设有不同权限",status:t.form.role_id?"":"尚未取得设置权限"}},t._l(t.roles,function(e,i){return a("div",{key:i,staticClass:"switch-cell"},[e.disabled?a("van-switch-cell",{attrs:{disabled:!e.disabled,title:e.role_name,value:t.form.role_id,"active-value":String(i),"active-color":"#67C23A","inactive-color":"#f2f6fc","value-class":"switch-cell-value"},on:{input:function(e){return t.onSwitchChange(i)}}}):t._e()],1)}),0):t._e()],1),a("van-popup",{attrs:{position:"bottom","get-container":"#app"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("van-picker",{ref:"picker",attrs:{defaultIndex:t.pickerIndex,"show-toolbar":"",title:"职务",visibleItemCount:3,columns:t.columns},on:{change:t.selectDuty,cancel:t.onCancel,confirm:function(e){t.show=!1}}}),a("van-field",{attrs:{size:"large","input-align":"right",label:"填写职务",placeholder:"请填写职务"},model:{value:t.duty,callback:function(e){t.duty=e},expression:"duty"}})],1),a("div",{staticClass:"footer-bar"},[a("van-button",{staticClass:"theme-btn",attrs:{square:"",loading:t.loading,"loading-text":"正在提交中...",type:"primary",size:"normal"},on:{click:t.sumbit}},[t._v("提 交")])],1)],1)},o=[],r=(a("3c6b"),a("7364"),a("34a3"),a("d4d5"),a("e20c")),n=a("9993"),s=a("b4bd"),c=a("77e0"),u=a("591a"),l={name:"teacherEdit",mixins:[c["b"],c["e"],c["g"]],computed:Object(r["a"])({},Object(u["c"])("manage",["manageSchoolInfo"])),data:function(){return{show:!1,pageType:this.$route.query.type,form:Object(r["a"])({},this.$route.query),isConfirm:this.$route.query.is_confirm,columns:s["d"],regPhone:/^1[34578]\d{9}$/,loading:!1,duty:"",roles:[],pickerIndex:0}},created:function(){this.fetchData(),this.form.duty||(this.form.duty="班主任")},watch:{$router:"fetchData",duty:function(t){this.form.duty=t}},methods:Object(r["a"])({},Object(u["b"])("manage",["getSchoolList"]),{fetchData:function(){var t=this;n["a"].get("/SchoolManage/teacher/getRoles").then(function(e){switch(e.data.status){case 1:var a=[],i=t.getDomDvt("修改老师"),o=i.value,n=[];o.map(function(e){e.when==Number(t.manageSchoolInfo.role_id)&&(n=e.value)}),e.data.data.map(function(t){var e=Object(r["a"])({},t);n.map(function(a){a==Number(t.id)&&(e.disabled=!0)}),a.push(e)}),t.roles=a;break;default:t.$toast(e.data.msg)}})},pickerShow:function(){var t=this;this.show=!0;var e=0;s["d"].map(function(a,i){a==t.form.duty&&(e=i)}),this.pickerIndex=e},past:function(){var t=this,e=1==this.isConfirm?"kick":"check";n["a"].get("/SchoolManage/teacher/".concat(e),{params:{id:this.$route.query.id}}).then(function(a){switch(a.data.status){case 1:t.isConfirm="".concat("kick"==e?0:1),t.$toast.success(a.data.msg);break;default:t.$toast(a.data.msg)}})},onSwitchChange:function(t){var e,a=this;switch(t){case 3:e="此操作将会把您的学校群主操作权限移交给".concat(this.form.username,",您确定吗?");break;case 2:e="".concat(3==this.role_id?"确定要取消".concat(this.form.username,"的管理权限吗?"):"确定要将".concat(this.form.username,"设置为管理员吗?"));break;case 1:e="此操作将会取消".concat(this.form.username,"的管理权限,您确定吗?");break;default:e="此操作将会变更".concat(this.form.username,"的相关权限,您确定吗?")}this.$dialog.confirm({message:e}).then(function(){var e=t==a.form.role_id?"0":String(t);n["a"].post("/SchoolManage/teacher/edit",Object(r["a"])({},a.form,{role_id:e})).then(function(t){switch(t.data.status){case 1:a.form.role_id=e,a.getSchoolList();break;default:a.$toast(t.data.msg)}})}).catch(function(){})},selectDuty:function(t,e,a){this.form.duty=e},onCancel:function(){this.show=!1,this.form.duty=this.$route.query.duty},toSelectBanjiPage:function(){this.$router.replace({name:"banjiList",query:Object(r["a"])({},this.$route.query,{year:this.classYear,back:this.$route.name})})},sumbit:function(){var t=this;switch(this.$route.query.type){case"edit":this.$dialog.confirm({message:"您确定要修改".concat(this.form.username,"的相关信息吗?")}).then(function(){t.loading=!0,n["a"].post("/SchoolManage/teacher/edit",Object(r["a"])({},t.form)).then(function(e){switch(t.loading=!1,e.data.status){case 1:t.$toast.success(e.data.msg),t.$router.go(-1);break;default:t.$toast(e.data.msg)}})}).catch(function(){});break;case"add":if(this.form.username)if(this.form.mobile)if(null==this.form.username.match(/^[\u4e00-\u9fa5]{2,4}$/i))this.$toast("请正确填写姓名");else if(this.regPhone.test(this.form.mobile)){this.loading=!0;var e=Object(r["a"])({},this.$route.query,this.form);n["a"].post("/SchoolManage/teacher/edit",e).then(function(e){switch(t.loading=!1,e.data.status){case 1:t.$toast.success(e.data.msg),t.$router.replace({name:"share",query:{school_id:t.$route.query.school_id,school_name:t.$route.query.school_name,banji_id:t.$route.query.banji_id,banji_name:t.$route.query.banji_name,invite_code:t.$route.query.invite_code,user_id:t.$route.query.user_id}});break;default:t.$toast(e.data.msg)}})}else this.$toast("请正确填写手机号");else this.$toast("请填写手机号");else this.$toast("请填写姓名");break}}})},d=l,h=(a("aa48"),a("17cc")),m=Object(h["a"])(d,i,o,!1,null,"7987ba37",null);e["default"]=m.exports}}]);