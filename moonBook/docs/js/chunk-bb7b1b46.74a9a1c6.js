(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bb7b1b46"],{"65fc":function(t,e,s){"use strict";var a=s("ee55"),i=s.n(a);i.a},"6d71":function(t,e,s){"use strict";var a=s("f221"),i=s.n(a);i.a},9077:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-popup-box"},[s("div",{staticClass:"w-popup-list"},[s("div",{staticClass:"w-tit-box flex flex-align"},[s("span"),t._v(t._s(t.filterList[0].title))]),s("van-row",{attrs:{gutter:"10"}},t._l(t.filterList[0].arr,function(e,a){return s("van-col",{key:a,attrs:{span:"8"}},[s("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"a-button",class:[a==t.selectIndex.selectAgeIndex?"selection":""],on:{click:function(s){return t.selectAge(e,a)}}},[t._v(t._s(e))])])}),1)],1),s("div",{staticClass:"w-popup-list"},[s("div",{staticClass:"w-tit-box flex flex-align"},[s("span"),t._v(t._s(t.filterList[1].title))]),s("van-row",{attrs:{gutter:"10"}},t._l(t.filterList[1].arr,function(e,a){return s("van-col",{key:a,attrs:{span:"8"}},[s("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"a-button",class:[a==t.selectIndex.selectClassifyIndex?"selection":""],on:{click:function(s){return t.selectClassify(e,a)}}},[t._v(t._s(e))])])}),1)],1),s("div",{staticClass:"w-popup-list"},[s("div",{staticClass:"w-tit-box flex flex-align"},[s("span"),t._v(t._s(t.filterList[2].title))]),s("van-row",{attrs:{gutter:"10"}},t._l(t.filterList[2].arr,function(e,a){return s("van-col",{key:a,attrs:{span:"8"}},[s("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"a-button",class:[a==t.selectIndex.selectFloorIndex?"selection":""],on:{click:function(s){return t.selectFloor(e,a)}}},[t._v(t._s(e))])])}),1)],1),s("div",{staticClass:"footer-bar flex"},[s("van-button",{staticClass:"btn",attrs:{square:"",text:"重置"},on:{click:t.onClickBtnLeft}}),s("van-button",{staticClass:"btn theme-btn",attrs:{square:"",text:"确定",type:"primary"},on:{click:t.onClickBtnRight}})],1)])},i=[],n={name:"filterPopup",props:["filterList"],data:function(){return{selectIndex:{selectAgeIndex:-1,selectClassifyIndex:-1,selectFloorIndex:-1},params:""}},watch:{selectIndex:{handler:function(t){var e=this.filterList[0].arr[t.selectAgeIndex],s=this.filterList[1].arr[t.selectClassifyIndex],a=t.selectFloorIndex+1,i=[e,s].join(",");this.params={tag:i,floor:a}},deep:!0}},methods:{onClickBtnLeft:function(){this.selectIndex.selectAgeIndex=-1,this.selectIndex.selectClassifyIndex=-1,this.selectIndex.selectFloorIndex=-1,this.params="",this.$emit("refresh")},onClickBtnRight:function(){this.$emit("onSelect",this.params)},selectAge:function(t,e){this.selectIndex.selectAgeIndex=this.selectIndex.selectAgeIndex==e?-1:e},selectClassify:function(t,e){this.selectIndex.selectClassifyIndex=this.selectIndex.selectClassifyIndex==e?-1:e},selectFloor:function(t,e){this.selectIndex.selectFloorIndex=this.selectIndex.selectFloorIndex==e?-1:e}}},l=n,o=(s("65fc"),s("2877")),c=Object(o["a"])(l,a,i,!1,null,"65b042f4",null);e["a"]=c.exports},9360:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bookshelf"},[s("form",{attrs:{action:"/"}},[s("van-search",{attrs:{placeholder:"请输入搜索关键词",shape:"round"},on:{search:t.onSearch},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[s("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"card-school-name theme-color",attrs:{slot:"label"},on:{click:t.toShcoolHome},slot:"label"},[t._v(t._s(t.userDataState.card_school_name))])])],1),s("van-tabs",{attrs:{color:"#0084ff","line-width":20,"line-height":4,sticky:"",swipeable:"",animated:"","title-inactive-color":"#303133",border:!1},on:{change:t.onChangeTab,click:t.onClick,disabled:t.onClickDisabled},model:{value:t.tabIndex,callback:function(e){t.tabIndex=e},expression:"tabIndex"}},[t.isNewPointShow?s("div",{staticClass:"new-point",attrs:{slot:"nav-right"},slot:"nav-right"}):t._e(),t._l(t.tab,function(e,a){return s("van-tab",{key:a,attrs:{title:e.title,disabled:"筛选"==e.title}},[s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("van-list",{attrs:{finished:t.finished,"finished-text":t.$store.state.slogan},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,function(a,i){return s("van-cell",{key:i},["最新"==e.title&&t.timediff(a,i)?s("div",{staticClass:"create-time theme-color"},[t._v("\n              "+t._s(t.getTimeAgo(a.create_time))+"\n            ")]):t._e(),s("bookCard",{attrs:{item:a,isCollect:a.is_collect},on:{like:t.likeBook}})],1)}),1)],1)],1)})],2),s("van-popup",{staticClass:"filter-popup",attrs:{position:"right"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("Filter-list",{attrs:{filterList:t.selectTag},on:{onSelect:t.onSelect,refresh:t.onReset,close:function(e){t.show=!1}}})],1)],1)},i=[],n=s("cebc"),l=s("9993"),o=s("be6b"),c=s("9077"),r=s("bec1"),d=s("591a"),h=s("77e0"),f={name:"bookshelf",mixins:[h["c"]],components:{bookCard:o["a"],FilterList:c["a"]},computed:Object(n["a"])({},Object(d["c"])(["userDataState"]),{isNewPointShow:function(){var t=!1,e=6048e5,s=Date.parse(new Date);return this.newBookDate&&(t=s>this.newBookDate&&s<this.newBookDate+e),t}}),data:function(){return{page:1,loading:!1,finished:!1,show:!1,keyword:"",tabIndex:1,selectTag:[{title:"年龄",arr:["3-5","5-6"]},{title:"分类",arr:["绘本","寓言故事","童话","科普","3D","VR","故事汇"]},{title:"所在层数",arr:["一层","二层","三层","四层","五层","六层"]}],tab:[{title:"最热",params:{sort:"hot"}},{title:"最新",params:{sort:"new"}},{title:"筛选"}],list:[],selsetData:"",newBookDate:""}},watch:{keyword:function(){this.list=[],this.onSearch()}},methods:{onLoad:function(){var t=this,e={params:{page:this.page,child_id:this.userDataState.child_id,card_id:this.userDataState.card_id}};switch(this.tab[this.tabIndex].title){case"最热":e.params.sort="hot";break;case"最新":e.params.sort="new";break;case"未读":e.params.sort="new",e.params.is_read=0;break}return this.selsetData&&(e.params.tag=this.selsetData.tag,e.params.floor=this.selsetData.floor),this.keyword&&(e.params.keyword=this.keyword),l["a"].get("/book/SchoolShelfBook/getList",e).then(function(e){switch(e.data.status){case 1:1==t.page?(t.list=e.data.data,t.newBookDate=1e3*e.data.data[0].create_time):t.list=t.list.concat(e.data.data),t.page++,t.loading=!1,t.list.length>=e.data.count&&(t.finished=!0);break;case 0:t.page=1,t.loading=!1,t.finished=!0,t.list=[];break}})},onRefresh:function(){var t=this;this.page=1,this.onLoad().then(function(){t.loading=!1,t.finished=!1})},onChangeTab:function(t){this.tabIndex=t,this.onRefresh()},onSearch:function(){this.onRefresh()},onClick:function(t){3==t&&(this.show=!0)},onClickDisabled:function(){this.show=!0},onReset:function(){this.selsetData="",this.onRefresh()},onSelect:function(t){this.show=!1,this.selsetData=t,this.onRefresh()},getTimeAgo:function(t){return Object(r["d"])(1e3*t,"yyyy-MM-dd")},timediff:function(t,e){if(0==e)return!0;if(e){var s=this.list[e-1]?Object(r["d"])(1e3*this.list[e-1].create_time,"yyyy-MM-dd"):0,a=Object(r["d"])(1e3*t.create_time,"yyyy-MM-dd");return s!=a}},toShcoolHome:function(){this.userDataState.card_school_id>0&&this.$router.push({name:"apps-school",query:{id:this.userDataState.card_school_id}})}}},u=f,p=(s("6d71"),s("2877")),v=Object(p["a"])(u,a,i,!1,null,"8cd54ab4",null);e["default"]=v.exports},ee55:function(t,e,s){},f221:function(t,e,s){}}]);