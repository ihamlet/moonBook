(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2500ee61"],{"216d":function(t,a,n){"use strict";var e=n("9b07"),i=n.n(e);i.a},"623b":function(t,a,n){"use strict";n.r(a);var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"borrow-list"},[n("van-nav-bar",{attrs:{title:t.$route.meta.title,"left-text":"我的","left-arrow":""}}),n("van-tabs",{attrs:{color:"#0084ff","line-width":20,"line-height":4,sticky:"",swipeable:"",animated:"",border:!1},on:{change:t.onChangeTab},model:{value:t.tabIndex,callback:function(a){t.tabIndex=a},expression:"tabIndex"}},t._l(t.tab,function(a,e){return n("van-tab",{key:e,attrs:{title:a.title}},[n("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":t.$store.state.slogan},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[a.content.length?n("div",{staticClass:"content"},t._l(a.content,function(a,e){return n("van-cell",{key:e},[n("van-row",{attrs:{gutter:"10"}},[n("van-col",{attrs:{span:"7"}},[n("div",{staticClass:"book-cover",on:{click:function(n){return t.toBookDetails(a)}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.thumb(a.thumb),expression:"thumb(item.thumb)"}],staticClass:"lazy"})])]),n("van-col",{attrs:{span:"11"}},[n("div",{staticClass:"book-info",on:{click:function(n){return t.toBookDetails(a)}}},[n("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:2,expression:"2",arg:"20"}],staticClass:"title"},[t._v(t._s(a.title))]),n("div",{staticClass:"attach"},[a.author?n("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"author"},[t._v("作者："+t._s(a.author))]):t._e()])])]),n("van-col",{attrs:{span:"6"}},[n("div",{staticClass:"flex flex-align button"},[n("div",{staticClass:"like",on:{click:function(n){return t.addCollect(a)}}},[a.is_collect?n("i",{staticClass:"iconfont"},[t._v("")]):n("i",{staticClass:"iconfont"},[t._v("")])]),n("div",{staticClass:"listening",on:{click:function(n){return t.listening(a)}}},[n("i",{staticClass:"iconfont"},[t._v("")])])])])],1)],1)}),1):n("div",{staticClass:"no-content"},[t._v("\n              还没有没有"+t._s(a.title)+"的书\n            ")])])],1)],1)}),1)],1)},i=[],o=(n("a481"),n("4917"),n("ac6a"),n("9993")),s={name:"borrow-list",data:function(){return{tab:[{title:"读过",content:[],type:"1"},{title:"在读",content:[],type:"0"},{title:"收藏",content:[],type:"book"},{title:"破损",content:[],type:"damaged"}],loading:!1,finished:!1,page:1,tabIndex:0}},methods:{onLoad:function(){this.tabIndex<2&&this.getReadList(),2==this.tabIndex&&this.getCollectList(),3==this.tabIndex&&this.getBrokenList()},getReadList:function(){var t=this,a={params:{page:this.page,is_return:this.tab[this.tabIndex].type}};return o["a"].get("/book/MemberBorrow/getList",a).then(function(a){if(1==a.data.status){if(a.data.count>0){var n=[],e=a.data.data;e.forEach(function(t){null!=t.book&&n.push(t.book)}),1==t.page?t.tab[t.tabIndex].content=n:t.tab[t.tabIndex].content=t.tab[t.tabIndex].content.concat(n),t.page++,t.loading=!1,t.tab[t.tabIndex].content.length>=a.data.count&&(t.finished=!0)}}else t.loading=!1,t.finished=!0,t.tab[t.tabIndex].content=[]})},getCollectList:function(){var t=this,a={params:{page:this.page,type:"book"}};return o["a"].get("/book/SchoolArticleCollect/getList",a).then(function(a){if(1==a.data.status&&a.data.count>0){var n=[],e=a.data.data;e.forEach(function(t){null!=t.book&&n.push(t.book)}),1==t.page?t.tab[t.tabIndex].content=n:t.tab[t.tabIndex].content=t.tab[t.tabIndex].content.concat(n),t.page++,t.loading=!1,t.tab[t.tabIndex].content.length>=a.data.count&&(t.finished=!0)}})},getBrokenList:function(){var t=this;return o["a"].get("/book/MemberBookBroken/getList").then(function(a){if(1==a.data.status&&a.data.count>0){var n=[],e=a.data.data;e.forEach(function(t){null!=t.book&&n.push(t.book)}),1==t.page?t.tab[t.tabIndex].content=n:t.tab[t.tabIndex].content=t.tab[t.tabIndex].content.concat(n),t.page++,t.loading=!1,t.tab[t.tabIndex].content.length>=a.data.count&&(t.finished=!0)}})},onChangeTab:function(t){this.tabIndex=t,this.page=1,this.onLoad()},onRefresh:function(){var t=this;this.page=1,this.tabIndex<2&&this.getReadList().then(function(){t.loading=!1,t.finished=!1}),2==this.tabIndex&&this.getCollectList().then(function(){t.loading=!1,t.finished=!1}),3==this.tabIndex&&this.getBrokenList().then(function(){t.loading=!1,t.finished=!1})},thumb:function(t){if(t){var a=t.match(/https?:\/\/(.+?)\//);return a?"/book/api/remotePic?url=".concat(t):t}},listening:function(t){var a=/（.+?）/,n=t.title.replace(a,""),e="https://m.ximalaya.com/search/".concat(n),i=localStorage.getItem("bookRead_"+t.tushu_id);i?location.href=e:o["a"].get("/book/story/updateRead").then(function(){localStorage.setItem("bookRead_"+t.tushu_id,!0),location.href=e})},toBookDetails:function(t){this.$router.push({name:"book-details",query:{id:t.tushu_id}})},addCollect:function(t){var a=this,n={params:{target_id:t.tushu_id,type_id:5}};o["a"].get("/book/member/add_favorite",n).then(function(n){1==n.data.status&&(a.$forceUpdate(),a.$set(t,"is_collect",!t.is_collect),t.is_collect&&a.$toast.success({className:"like-icon toast-icon",message:"喜欢",duration:"800"}))})}}},c=s,l=(n("216d"),n("2877")),d=Object(l["a"])(c,e,i,!1,null,"5829a260",null);a["default"]=d.exports},"9b07":function(t,a,n){}}]);