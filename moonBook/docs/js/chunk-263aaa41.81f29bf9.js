(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-263aaa41"],{"12cc":function(t,a,e){},5778:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"avatar-default",class:[t.size,t.avatarClass]},[1==t.gender?e("img",{attrs:{src:"https://assets-moonbook.oss-cn-beijing.aliyuncs.com/img/boy-avatar.png",alt:"默认男孩头像"}}):e("img",{attrs:{src:"https://assets-moonbook.oss-cn-beijing.aliyuncs.com/img/girl-avatar.png",alt:"默认女孩头像"}})])},s=[],n={name:"avatar",props:["gender","size","avatarClass"]},o=n,r=(e("7335"),e("17cc")),c=Object(r["a"])(o,i,s,!1,null,"ba617808",null);a["a"]=c.exports},7335:function(t,a,e){"use strict";var i=e("12cc"),s=e.n(i);s.a},"86b5":function(t,a,e){"use strict";var i=e("d62d"),s=e.n(i);s.a},9274:function(t,a,e){"use strict";var i=e("a54b"),s=e.n(i);s.a},a54b:function(t,a,e){},d248:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"welt"},t._l(t.round,function(t,a){return e("div",{key:a,staticClass:"round",class:"round-"+a,style:{width:t.w,height:t.w}})}),0)},s=[],n={name:"round",data:function(){return{round:[{w:"300px"},{w:"100px"},{w:"50px"},{w:"200px"},{w:"60px"}]}}},o=n,r=(e("9274"),e("17cc")),c=Object(r["a"])(o,i,s,!1,null,"2b981942",null);a["a"]=c.exports},d62d:function(t,a,e){},dfe8:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"edit-class page-padding"},[e("van-nav-bar",{key:t.$route.query.id,attrs:{border:!1,fixed:"",title:t.schoolName}}),e("div",{staticClass:"container"},["teacher"!=t.$route.query.registerType?e("div",{staticClass:"baby-info flex flex-justify"},[t.avatar?e("div",{staticClass:"avatar flex"},[e("img",{directives:[{name:"http2https",rawName:"v-http2https"}],attrs:{src:t.avatar}})]):e("avatar"),e("div",{staticClass:"name"},[t._v(t._s(t.childInfo.name)+"（"+t._s(t.childInfo.age||t.age)+"岁）")]),e("round",{staticClass:"bg-round"})],1):t._e(),e("div",{staticClass:"title"},[t._v(t._s(t.list.length?"请选择班级":"")+" ")]),e("div",{staticClass:"list"},[e("van-list",{attrs:{finished:t.finished,"finished-text":t.$store.state.slogan},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[t.list.length?e("div",{staticClass:"content"},t._l(t.list,function(a,i){return e("div",{key:i,attrs:{size:"large","is-link":""},on:{click:function(e){return t.select(a,i)}}},[a.year>"0"?e("div",{staticClass:"banji-item"},[t.isYearShow(a,i)?e("div",{staticClass:"year theme-color"},[t._v(t._s(a.year))]):t._e(),e("van-cell",{attrs:{"is-link":""}},[e("div",{staticClass:"banji-cell flex flex-align"},[e("div",{staticClass:"banji-name"},[t._v("\n                    "+t._s(t.formatBanjiTitle(a.title))+"\n                  ")]),e("div",{staticClass:"add-value"},[t._v("\n                    "+t._s(a.student_count)+"人已加入\n                  ")])])])],1):t._e()])}),0):e("div",{staticClass:"theme-color no-content"},[e("van-button",{staticClass:"theme-btn",attrs:{plain:"",type:"primary"},on:{click:function(a){t.show=!0}}},[t._v("请添加班级")])],1)])],1)]),t.list?t._e():e("div",{staticClass:"add-school"},[e("div",{staticClass:"fx-box flex flex-align"},[e("div",{staticClass:"theme-color"},[t._v("没有你所在的班级？")]),e("van-button",{staticClass:"theme-btn",attrs:{type:"primary",size:"small",round:""},on:{click:function(a){t.show=!0}}},[t._v("添加班级")])],1)]),e("van-dialog",{attrs:{"show-cancel-button":"","before-close":t.beforeClose,getContainer:"#app"},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[e("div",{staticClass:"dialog-title"},[t._v("添加班级")]),e("van-cell-group",[e("van-field",{attrs:{label:"班级名称",placeholder:"请输入班级名称","input-align":"right"},model:{value:t.className,callback:function(a){t.className=a},expression:"className"}})],1)],1),e("van-dialog",{attrs:{"show-cancel-button":"",confirmButtonText:"忽略",cancelButtonText:"重新选择","before-close":t.codeBeforeClose,getContainer:"#app"},model:{value:t.showCode,callback:function(a){t.showCode=a},expression:"showCode"}},[e("div",{staticClass:"dialog-title tips"},[e("div",{staticClass:"prompt-text"},[t._v("填写邀请码直接进入班级")]),e("div",{staticClass:"prompt"},[t._v("点击忽略请等待老师审核通过")])]),e("van-cell-group",{attrs:{border:!1}},[e("div",{staticClass:"flex flex-align"},[e("van-field",{staticClass:"dialog-field",attrs:{maxlength:"4",placeholder:"请填写邀请码","input-align":"center",border:!1},model:{value:t.code,callback:function(a){t.code=a},expression:"code"}}),e("van-button",{staticClass:"dialog-btn theme-btn",attrs:{type:"primary",square:"",size:"normal"},on:{click:t.verification}},[t._v("进入班级")])],1)])],1)],1)},s=[],n=(e("34a3"),e("7364"),e("e20c")),o=e("9993"),r=e("591a"),c=e("77e0"),l=(e("bec1"),e("5778")),d=e("d248"),u={name:"edit-class",mixins:[c["b"],c["e"]],components:{avatar:l["a"],round:d["a"]},computed:Object(n["a"])({},Object(r["c"])(["userDataState"]),{avatar:function(){var t;return t="type"==this.$route.query.type?childInfo.avatar:this.$route.query.avatar,t},age:function(){var t=new Date,a=t.getFullYear(),e=this.$route.query.birthday?this.$route.query.birthday.substring(0,4):a;return a-e}}),data:function(){return{list:[],loading:!1,finished:!1,page:1,childInfo:"",schoolName:"",className:"",code:"",show:!1,showCode:!1,itemIndex:0}},created:function(){this.fetchData()},watch:{$router:"fetchData"},methods:Object(n["a"])({},Object(r["b"])(["getUserData","managerState"]),{fetchData:function(){this.schoolName=this.$route.query.school_name,this.childInfo={name:this.$route.query.name,age:this.$route.query.age||0,avatar:this.$route.query.avatar}},beforeClose:function(t,a){var e=this;if("confirm"===t){var i={school_id:this.$route.query.school_id,title:this.className,year:this.classYear};o["a"].post("/book/school/edit_banji",i).then(function(t){switch(t.data.status){case 1:"teacher"==e.$route.query.registerType?e.$router.replace({name:"edit-manager",query:Object(n["a"])({},e.$route.query,{banji_name:t.data.data.title,banji_id:t.data.data.banji_id,back:e.$route.name})}):e.$router.replace({name:"edit-child",query:Object(n["a"])({},e.$route.query,{banji_id:t.data.data.banji_id,child_id:e.$route.query.id,id:e.$route.query.id,invite_code:e.code})});break;case 0:e.$toast(t.data.msg);break}})}else this.$router.go(-1)},codeBeforeClose:function(t,a){if("confirm"===t){var e=Object(n["a"])({},this.$route.query,{banji_id:this.list[this.itemIndex].banji_id,banji_name:this.list[this.itemIndex].title,invite_code:this.code||this.list[this.itemIndex].invite_code});this.$router.replace({name:"edit-child",query:e}),a()}else a()},select:function(t,a){if(this.$route.query.registerType)this.$router.replace({name:"edit-manager",query:Object(n["a"])({},this.$route.query,{banji_name:t.title,banji_id:t.banji_id,back:this.$route.name})});else{var e={params:{child_id:this.$route.query.id,banji_id:t.banji_id,banji_name:t.title,invite_code:this.code}};t.invite_code?(this.showCode=!0,this.itemIndex=a):this.babyJoin(e)}},babyJoin:function(t){var a=this;o["a"].get("/book/baby/join_banji",t).then(function(t){1==t.data.status?(a.$toast("成功提交申请"),a.$router.go(-1),a.getUserData()):(a.$toast.fail("加入失败"),a.$router.replace({name:"my-home"}))})},onLoad:function(){var t=this,a={params:{page:this.page,limit:20,school_id:this.$route.query.school_id,year:this.classYear}};o["a"].get("/book/SchoolBanji/getList",a).then(function(a){switch(a.data.status){case 1:0==a.data.count?(t.show=!0,t.page=1,t.loading=!1,t.finished=!0):(t.page++,t.list=t.list.concat(a.data.data),t.loading=!1,t.list.length>=a.data.count&&(t.finished=!0));break}})},isYearShow:function(t,a){var e;return a>0&&(e=this.list[a-1].year),t.year!=e},verification:function(){var t={params:{banji_id:this.list[this.itemIndex].banji_id,child_id:this.$route.query.id,invite_code:this.code}};this.code&&this.code.length?this.list[this.itemIndex].invite_code==this.code?this.babyJoin(t):this.$toast("邀请码不正确"):this.$toast("请输入邀请码")}})},h=u,v=(e("86b5"),e("17cc")),b=Object(v["a"])(h,i,s,!1,null,"1ee40408",null);a["default"]=b.exports}}]);
//# sourceMappingURL=chunk-263aaa41.81f29bf9.js.map