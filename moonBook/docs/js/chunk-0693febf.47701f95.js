(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0693febf"],{"2e44":function(t,e,a){},5778:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"avatar-default",class:[t.size,t.avatarClass]},[1==t.gender?a("img",{attrs:{src:"https://assets-moonbook.oss-cn-beijing.aliyuncs.com/img/boy-avatar.png",alt:"默认男孩头像"}}):a("img",{attrs:{src:"https://assets-moonbook.oss-cn-beijing.aliyuncs.com/img/girl-avatar.png",alt:"默认女孩头像"}})])},s=[],n={name:"avatar",props:["gender","size","avatarClass"]},o=n,r=(a("7335"),a("2877")),c=Object(r["a"])(o,i,s,!1,null,"ba617808",null);e["a"]=c.exports},5902:function(t,e,a){},7335:function(t,e,a){"use strict";var i=a("2e44"),s=a.n(i);s.a},9274:function(t,e,a){"use strict";var i=a("5902"),s=a.n(i);s.a},9643:function(t,e,a){},d248:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"welt"},t._l(t.round,function(t,e){return a("div",{key:e,staticClass:"round",class:"round-"+e,style:{width:t.w,height:t.w}})}),0)},s=[],n={name:"round",data:function(){return{round:[{w:"300px"},{w:"100px"},{w:"50px"},{w:"200px"},{w:"60px"}]}}},o=n,r=(a("9274"),a("2877")),c=Object(r["a"])(o,i,s,!1,null,"2b981942",null);e["a"]=c.exports},dfe8:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-class page-padding"},[a("van-nav-bar",{key:t.$route.query.id,attrs:{border:!1,fixed:"",title:t.schoolName}}),a("div",{staticClass:"container"},["teacher"!=t.$route.query.registerType?a("div",{staticClass:"baby-info flex flex-justify"},[t.avatar?a("div",{staticClass:"avatar flex"},[a("img",{directives:[{name:"http2https",rawName:"v-http2https"}],attrs:{src:t.avatar}})]):a("avatar"),a("div",{staticClass:"name"},[t._v(t._s(t.childInfo.name)+"（"+t._s(t.childInfo.age||t.age)+"岁）")]),a("round",{staticClass:"bg-round"})],1):t._e(),a("div",{staticClass:"title"},[t._v(t._s(t.list.length?"请选择班级":"")+" ")]),a("div",{staticClass:"list"},[a("van-list",{attrs:{finished:t.finished,"finished-text":t.$store.state.slogan},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t.list.length?a("div",{staticClass:"content"},t._l(t.list,function(e,i){return a("div",{key:i,attrs:{size:"large","is-link":""},on:{click:function(a){return t.select(e,i)}}},[e.year>"0"?a("div",{staticClass:"banji-item"},[t.isYearShow(e,i)?a("div",{staticClass:"year theme-color"},[t._v(t._s(e.year))]):t._e(),a("van-cell",{attrs:{"is-link":""}},[a("div",{staticClass:"banji-cell flex flex-align"},[a("div",{staticClass:"banji-name"},[t._v("\n                    "+t._s(t.formatBanjiTitle(e.title))+"\n                  ")]),a("div",{staticClass:"add-value"},[t._v("\n                    "+t._s(e.student_count)+"人已加入\n                  ")])])])],1):t._e()])}),0):a("div",{staticClass:"theme-color no-content"},[a("van-button",{staticClass:"theme-btn",attrs:{plain:"",type:"primary"},on:{click:function(e){t.show=!0}}},[t._v("请添加班级")])],1)])],1)]),t.list?t._e():a("div",{staticClass:"add-school"},[a("div",{staticClass:"fx-box flex flex-align"},[a("div",{staticClass:"theme-color"},[t._v("没有你所在的班级？")]),a("van-button",{staticClass:"theme-btn",attrs:{type:"primary",size:"small",round:""},on:{click:function(e){t.show=!0}}},[t._v("添加班级")])],1)]),a("van-dialog",{attrs:{"show-cancel-button":"","before-close":t.beforeClose,getContainer:"#app"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"dialog-title"},[t._v("添加班级")]),a("van-cell-group",[a("van-field",{attrs:{label:"班级名称",placeholder:"请输入班级名称","input-align":"right"},model:{value:t.className,callback:function(e){t.className=e},expression:"className"}})],1)],1),a("van-dialog",{attrs:{"show-cancel-button":"",confirmButtonText:"忽略",cancelButtonText:"重新选择","before-close":t.codeBeforeClose,getContainer:"#app"},model:{value:t.showCode,callback:function(e){t.showCode=e},expression:"showCode"}},[a("div",{staticClass:"dialog-title tips"},[a("div",{staticClass:"prompt-text"},[t._v("填写邀请码直接进入班级")]),a("div",{staticClass:"prompt"},[t._v("点击忽略请等待老师审核通过")])]),a("van-cell-group",{attrs:{border:!1}},[a("div",{staticClass:"flex flex-align"},[a("van-field",{staticClass:"dialog-field",attrs:{maxlength:"4",placeholder:"请填写邀请码","input-align":"center",border:!1},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}}),a("van-button",{staticClass:"dialog-btn theme-btn",attrs:{type:"primary",square:"",size:"normal"},on:{click:t.verification}},[t._v("进入班级")])],1)])],1)],1)},s=[],n=(a("a481"),a("7f7f"),a("cebc")),o=a("9993"),r=a("591a"),c=a("77e0"),l=a("5778"),d=a("d248"),u={name:"edit-class",mixins:[c["b"],c["e"]],components:{avatar:l["a"],round:d["a"]},computed:Object(n["a"])({},Object(r["c"])(["userDataState"]),{avatar:function(){var t;return t="type"==this.$route.query.type?this.childInfo.avatar:this.$route.query.avatar,t},age:function(){var t=new Date,e=t.getFullYear(),a=this.$route.query.birthday?this.$route.query.birthday.substring(0,4):e;return e-a}}),data:function(){return{list:[],loading:!1,finished:!1,page:1,childInfo:"",schoolName:"",className:"",code:"",show:!1,showCode:!1,itemIndex:0}},created:function(){this.fetchData()},watch:{$router:"fetchData"},methods:Object(n["a"])({},Object(r["b"])(["getUserData","managerState"]),{fetchData:function(){this.schoolName=this.$route.query.school_name,this.childInfo={name:this.$route.query.name,age:this.$route.query.age||0,avatar:this.$route.query.avatar}},beforeClose:function(t){var e=this;if("confirm"===t){var a={school_id:this.$route.query.school_id,title:this.className,year:this.classYear};o["a"].post("/book/school/edit_banji",a).then(function(t){switch(t.data.status){case 1:"teacher"==e.$route.query.registerType?e.$router.replace({name:"edit-manager",query:Object(n["a"])({},e.$route.query,{banji_name:t.data.data.title,banji_id:t.data.data.banji_id,back:e.$route.name})}):e.$router.replace({name:"edit-child",query:Object(n["a"])({},e.$route.query,{banji_id:t.data.data.banji_id,child_id:e.$route.query.id,id:e.$route.query.id,invite_code:e.code})});break;case 0:e.$toast(t.data.msg);break}})}else this.$router.go(-1)},codeBeforeClose:function(t,e){if("confirm"===t){var a=Object(n["a"])({},this.$route.query,{banji_id:this.list[this.itemIndex].banji_id,banji_name:this.list[this.itemIndex].title,invite_code:this.code||this.list[this.itemIndex].invite_code});this.$router.replace({name:"edit-child",query:a}),e()}else e()},select:function(t,e){if(this.$route.query.registerType)this.$router.replace({name:"edit-manager",query:Object(n["a"])({},this.$route.query,{banji_name:t.title,banji_id:t.banji_id,back:this.$route.name})});else{var a={params:{child_id:this.$route.query.id,banji_id:t.banji_id,banji_name:t.title,invite_code:this.code}};t.invite_code?(this.showCode=!0,this.itemIndex=e):this.babyJoin(a)}},babyJoin:function(t){var e=this;o["a"].get("/book/baby/join_banji",t).then(function(t){1==t.data.status?(e.$toast("成功提交申请"),e.$router.go(-1),e.getUserData()):(e.$toast.fail("加入失败"),e.$router.replace({name:"my-home"}))})},onLoad:function(){var t=this,e={params:{page:this.page,limit:20,school_id:this.$route.query.school_id,year:this.classYear}};o["a"].get("/book/SchoolBanji/getList",e).then(function(e){switch(e.data.status){case 1:0==e.data.count?(t.show=!0,t.page=1,t.loading=!1,t.finished=!0):(t.page++,t.list=t.list.concat(e.data.data),t.loading=!1,t.list.length>=e.data.count&&(t.finished=!0));break}})},isYearShow:function(t,e){var a;return e>0&&(a=this.list[e-1].year),t.year!=a},verification:function(){var t={params:{banji_id:this.list[this.itemIndex].banji_id,child_id:this.$route.query.id,invite_code:this.code}};this.code&&this.code.length?this.list[this.itemIndex].invite_code==this.code?this.babyJoin(t):this.$toast("邀请码不正确"):this.$toast("请输入邀请码")}})},h=u,v=(a("fe42"),a("2877")),f=Object(v["a"])(h,i,s,!1,null,"35b6ee2b",null);e["default"]=f.exports},fe42:function(t,e,a){"use strict";var i=a("9643"),s=a.n(i);s.a}}]);