(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-99ee50c8"],{"4bc8":function(t,a,e){"use strict";var n=e("aced"),i=e.n(n);i.a},"623b":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"borrow-list"},[e("van-nav-bar",{attrs:{title:t.$route.meta.title,"left-text":"我的","left-arrow":""}}),e("van-tabs",{attrs:{color:"#0084ff","line-width":20,"line-height":4,sticky:"",swipeable:"",animated:"",border:!1},on:{change:t.onChangeTab},model:{value:t.tabIndex,callback:function(a){t.tabIndex=a},expression:"tabIndex"}},t._l(t.tab,function(a,n){return e("van-tab",{key:n,attrs:{title:a.title}},[e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":t.$store.state.slogan},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},[a.content.length?e("div",{staticClass:"content"},t._l(a.content,function(a,n){return e("van-cell",{key:n},[e("van-row",{attrs:{gutter:"10"}},[e("van-col",{attrs:{span:"7"}},[e("div",{staticClass:"book-cover",on:{click:function(e){return t.toBookDetails(a)}}},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.thumb(a.thumb),expression:"thumb(item.thumb)"}],staticClass:"lazy"})])]),e("van-col",{attrs:{span:"11"}},[e("div",{staticClass:"book-info",on:{click:function(e){return t.toBookDetails(a)}}},[e("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:2,expression:"2",arg:"20"}],staticClass:"title"},[t._v(t._s(a.title))]),e("div",{staticClass:"attach"},[a.author?e("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"author"},[t._v("作者："+t._s(a.author))]):t._e()])])]),e("van-col",{attrs:{span:"6"}},[e("div",{staticClass:"flex flex-align button"},[e("div",{staticClass:"like",on:{click:function(e){return t.addCollect(a)}}},[a.is_collect?e("i",{staticClass:"iconfont"},[t._v("")]):e("i",{staticClass:"iconfont"},[t._v("")])]),e("div",{staticClass:"listening",on:{click:function(e){return t.listening(a)}}},[e("i",{staticClass:"iconfont"},[t._v("")])])])])],1)],1)}),1):e("div",{staticClass:"no-content"},[t._v("\n              还没有没有"+t._s(a.title)+"的书\n            ")])])],1)],1)}),1)],1)},i=[],o=(e("a481"),e("4917"),e("ac6a"),e("9993")),s={name:"borrow-list",data:function(){return{tab:[{title:"读过",content:[],type:"1"},{title:"在读",content:[],type:"0"},{title:"收藏",content:[],type:"book"},{title:"破损",content:[],type:"damaged"}],loading:!1,finished:!1,page:1,tabIndex:0}},methods:{onLoad:function(){this.tabIndex<2&&this.getReadList(),2==this.tabIndex&&this.getCollectList(),3==this.tabIndex&&this.getBrokenList()},getReadList:function(){var t=this,a={params:{page:this.page,is_return:this.tab[this.tabIndex].type}};return o["a"].get("/book/MemberBorrow/getList",a).then(function(a){if(1==a.data.status){if(a.data.count>0){var e=[],n=a.data.data;n.forEach(function(t){null!=t.book&&e.push(t.book)}),1==t.page?t.tab[t.tabIndex].content=e:t.tab[t.tabIndex].content=t.tab[t.tabIndex].content.concat(e),t.page++,t.loading=!1,t.tab[t.tabIndex].content.length>=a.data.count&&(t.finished=!0)}}else t.loading=!1,t.finished=!0,t.tab[t.tabIndex].content=[]})},getCollectList:function(){var t=this,a={params:{page:this.page,type:"book"}};return o["a"].get("/book/SchoolArticleCollect/getList",a).then(function(a){if(1==a.data.status&&a.data.count>0){var e=[],n=a.data.data;n.forEach(function(t){null!=t.book&&e.push(t.book)}),1==t.page?t.tab[t.tabIndex].content=e:t.tab[t.tabIndex].content=t.tab[t.tabIndex].content.concat(e),t.page++,t.loading=!1,t.tab[t.tabIndex].content.length>=a.data.count&&(t.finished=!0)}})},getBrokenList:function(){var t=this;return o["a"].get("/book/MemberBookBroken/getList").then(function(a){if(1==a.data.status&&a.data.count>0){var e=[],n=a.data.data;n.forEach(function(t){null!=t.book&&e.push(t.book)}),1==t.page?t.tab[t.tabIndex].content=e:t.tab[t.tabIndex].content=t.tab[t.tabIndex].content.concat(e),t.page++,t.loading=!1,t.tab[t.tabIndex].content.length>=a.data.count&&(t.finished=!0)}})},onChangeTab:function(t){this.tabIndex=t,this.page=1,this.onLoad()},onRefresh:function(){var t=this;this.page=1,this.tabIndex<2&&this.getReadList().then(function(a){t.loading=!1,t.finished=!1}),2==this.tabIndex&&this.getCollectList().then(function(a){t.loading=!1,t.finished=!1}),3==this.tabIndex&&this.getBrokenList().then(function(a){t.loading=!1,t.finished=!1})},thumb:function(t){if(t){var a=t.match(/https?:\/\/(.+?)\//);return a?"/book/api/remotePic?url=".concat(t):t}},listening:function(t){var a=/（.+?）/,e=t.title.replace(a,""),n="https://m.ximalaya.com/search/".concat(e),i=localStorage.getItem("bookRead_"+t.tushu_id);i?location.href=n:o["a"].get("/book/story/updateRead").then(function(a){localStorage.setItem("bookRead_"+t.tushu_id,!0),location.href=n})},toBookDetails:function(t){this.$router.push({name:"book-details",query:{id:t.tushu_id}})},addCollect:function(t){var a=this,e={params:{target_id:t.tushu_id,type_id:5}};o["a"].get("/book/member/add_favorite",e).then(function(e){1==e.data.status&&(a.$forceUpdate(),a.$set(t,"is_collect",!t.is_collect),t.is_collect&&a.$toast.success({className:"like-icon toast-icon",message:"喜欢",duration:"800"}))})}}},c=s,l=(e("4bc8"),e("2877")),d=Object(l["a"])(c,n,i,!1,null,"53e4be4a",null);a["default"]=d.exports},aced:function(t,a,e){}}]);
//# sourceMappingURL=chunk-99ee50c8.c65fce69.js.map