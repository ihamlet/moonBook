(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-630f37a0"],{"06d7":function(t,e,a){},1776:function(t,e,a){"use strict";var i=a("06d7"),s=a.n(i);s.a},"2d08":function(t,e,a){"use strict";var i=a("687c"),s=a.n(i);s.a},5719:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.hackReset?a("div",{staticClass:"school-home page-padding"},[a("van-nav-bar",{key:t.$route.query.id,class:t.fixedHeaderBar?"theme-nav":"",attrs:{zIndex:100,fixed:"",border:!1}},[a("div",{staticClass:"head-bar-title",attrs:{slot:"title"},on:{click:function(e){t.actionsheetShow=!0}},slot:"title"},[t._v("\n      "+t._s(t.fixedHeaderBar?t.$route.meta.title:t.schoolInfo.title)+" "),a("i",{staticClass:"iconfont"},[t._v("")])]),t.manage?a("div",{staticClass:"theme-color",attrs:{slot:"right"},on:{click:t.toManage},slot:"right"},[t._v("\n      学校管理\n    ")]):t._e()]),a("div",{staticClass:"container"},[a("div",{ref:"domHeight",staticClass:"header-card flex flex-align theme-school-background"},[a("div",{staticClass:"school-info"},[a("div",{staticClass:"school-logo"},[a("img",{attrs:{src:t.schoolInfo.logo,alt:t.schoolInfo.title},on:{error:t.imgError}})]),a("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"school-name"},[t._v(t._s(t.schoolInfo.title))]),a("div",{staticClass:"run-type"},[t._v(t._s(t.schoolInfo.run_type))])]),a("div",{staticClass:"arc"})]),a("div",{staticClass:"apps"},[a("apps",{attrs:{appsList:t.appsList,type:"schoolHome"}})],1),a("div",{staticClass:"module card-top"},[a("investmentAd",{attrs:{investmentAd:t.investment,type:"notice"}})],1),a("div",{staticClass:"module"},[a("read-list",{attrs:{type:"school",title:"阅读榜",field:"name"}})],1),a("div",{staticClass:"list"},[a("van-tabs",{attrs:{color:"#0084ff","line-width":20,"line-height":4,animated:"",swipeable:"",border:!1}},t._l(t.tab,function(e,i){return a("van-tab",{key:i,attrs:{title:e.title}},[a("div",{staticClass:"tab-content"},[a("drying-list",{ref:"reloadDom",refInFor:!0,attrs:{school_id:t.$route.query.id,portal_name:"学校主页"}})],1)])}),1)],1)]),t.userDataState.teacher_school_id==t.$route.query.id?a("div",{staticClass:"release-footer-bar"},[a("van-button",{staticClass:"theme-btn theme-release",attrs:{round:"",size:"normal",type:"primary"},on:{click:function(e){return t.setReleaseSwitch(!0)}}},[a("i",{staticClass:"iconfont"},[t._v("")]),t._v("\n      发 布\n    ")]),a("van-popup",{staticClass:"tips-popup",attrs:{overlayStyle:{backgroundColor:"transparent"},"get-container":".footer-bar","lock-scroll":!1},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("tips",{attrs:{isShow:t.show,position:"bottom"},on:{close:function(e){return t.setReleaseSwitch(!1)}}})],1)],1):t._e(),a("van-action-sheet",{attrs:{actions:t.manageActions,"cancel-text":"取消","get-container":"#app"},on:{select:t.onSelect},model:{value:t.actionsheetShow,callback:function(e){t.actionsheetShow=e},expression:"actionsheetShow"}})],1):t._e()},s=[],o=(a("4453"),a("089b")),n=(a("34a3"),a("7364"),a("f763"),a("e20c")),c=a("9993"),r=a("591a"),l=a("77e0"),h=a("3224"),u=a("8c63"),d=a("a009"),p=a("6d4b"),m=a("0606"),f={name:"school",mixins:[l["d"],l["h"]],components:{apps:h["a"],readList:u["a"],dryingList:d["a"],investmentAd:p["a"],tips:m["a"]},computed:Object(n["a"])({},Object(r["e"])(["releaseSwitch"]),Object(r["c"])(["userDataState","managerState"]),{show:{get:function(){return this.releaseSwitch},set:function(t){this.setReleaseSwitch(t)}},manage:function(){var t,e=this;if(this.managerState)return this.managerState.forEach(function(a){e.$route.query.id==a.id&&"parent"!=a.item_relation&&(t=!0)}),t}}),data:function(){return{schoolInfo:"",actionsheetShow:!1,appsList:[{name:"介绍",iconClass:"icon-fengche",path:"school-intro"},{name:"荣誉",iconClass:"icon-jiangbei",path:"apps-find"},{name:"阅读",iconClass:"icon-yuedu",path:"apps-find"},{name:"才艺",iconClass:"icon-tiaosepan",path:"apps-find"}],tab:[{title:"学校动态",content:""}],investment:{link:"#",text:"今日餐谱",banner:""}}},beforeRouteEnter:function(t,e,a){a(function(t){t.request()})},methods:Object(n["a"])({},Object(r["d"])(["setReleaseSwitch"]),Object(r["b"])("manage",["getSchoolList"]),{request:function(){var t=this;"preview"!=this.$route.query.type?null!=this.userDataState.id?"0"==this.userDataState.teacher_school_id?"0"==this.userDataState.child_id?this.$dialog.confirm({title:"添加宝贝",message:"请添加您的宝贝，掌握孩子阅读数据",confirmButtonText:"添加",cancelButtonText:"稍后",showCancelButton:!0}).then(function(){t.$router.push({name:"edit-child",query:{type:"add",pageTitle:"添加宝贝",banji_id:t.$route.query.id,school_id:t.$route.query.school_id,banji_name:t.$route.query.banji_name,school_name:t.$route.query.school_name}}),localStorage.removeItem("childInfo")}).catch(function(){t.backRouter()}):"0"==res.school_id?this.$dialog.confirm({title:"加入学校",message:"请加入学校，掌握学校动态",confirmButtonText:"添加",cancelButtonText:"稍后",showCancelButton:!0}).then(function(){t.$router.push({name:"edit-school",query:{type:"add",enter:"my-home",id:res.child_id}})}).catch(function(){t.backRouter()}):this.getSchoolInfo():this.getSchoolInfo():(this.$toast.fail("获取信息失败"),this.$router.push({name:"home"})):this.getSchoolInfo()},getSchoolInfo:function(){var t=this,e={params:{school_id:this.$route.query.id}};this.$route.query.id&&""!=this.$route.query.id&&(c["a"].get("/book/school/get_info",e).then(function(e){1==e.data.status&&(t.schoolInfo=e.data.data)}),this.getCate())},onSelect:function(t){switch(this.actionsheetShow=!1,t.type){case"banji":this.$router.push({name:"class-home",query:{id:t.id,back:this.$route.name}});break;case"school":this.$router.replace({name:"apps-school",query:{id:t.id,back:this.$route.name,banji_id:this.$route.query.id}});break;case"toSchoolList":this.$router.push({name:"AcceptSchoolList",query:{type:"page"}});break}this.refreshPage(),this.$route.meta.keepAlive=!1},imgError:function(t){t.target.src="https://wx.qlogo.cn/mmopen/ajNVdqHZLLBGT5R0spIjic7Pobf19Uw0qc07mwPLicXILrafUXYkhtMTZ0WialrHiadXDKibJsRTux0WvmNuDyYRWDw/0"},backRouter:function(){"apps-school"==this.$route.name?this.$router.replace({name:"AcceptSchoolList",query:{type:"page"}}):this.$router.go(-1)},getCate:function(){var t=this,e={params:{portal_name:"学校主页"}};c["a"].get("/book/schoolArticleCate/getList",e).then(function(e){if(200==e.status){var a=e.data,i=[];a.forEach(function(e){0==e.access_level?i.push(e):t.managerState.forEach(function(a){t.$route.query.id!=a.banji_id&&t.$route.query.id!=a.school_id||"parent"==a.item_relation||i.push(e)})}),t.appsList.forEach(function(e){var a;i.forEach(function(i){e.name==i.cate_name&&(a={tag_id:i.cate_id,pageTitle:i.cate_name,school_id:t.$route.query.id,id:t.$route.query.id,back:t.$route.name})}),"school-intro"==e.path?e.params={id:t.$route.query.id}:e.params=a})}})},toManage:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getSchoolList(this.$route.query.id);case 2:this.$router.push({name:"manageSchool",query:{sid:this.$route.query.id,back:this.$route.name}});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()})},g=f,v=(a("2d08"),a("17cc")),b=Object(v["a"])(g,i,s,!1,null,"7c4cb56b",null);e["default"]=b.exports},"5c8c":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"slogan"},[t._v("\n    "+t._s(t.$store.state.slogan)+"\n")])},s=[],o={name:"slogan"},n=o,c=(a("d071"),a("17cc")),r=Object(c["a"])(n,i,s,!1,null,"ef722a5e",null);e["a"]=r.exports},"687c":function(t,e,a){},"6d4b":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"investment"},[t.isAdshow&&"apps-school"!=t.$route.name?a("div",{staticClass:"light-box"},[a("div",{staticClass:"close",on:{click:t.hideAd}},[a("i",{staticClass:"iconfont"},[t._v("")])]),"apps-school"!=t.$route.name?a("a",{attrs:{href:t.investmentAd.link}},[a("img",{attrs:{src:t.investmentAd.banner,alt:"加盟商广告"}})]):t._e()]):t._e(),a("div",{staticClass:"box"},[a("van-row",{staticClass:"flex flex-align",attrs:{gutter:"10"}},[a("van-col",{attrs:{span:"7"}},[a("a",{staticClass:"box-link",attrs:{href:t.investmentAd.link}},[t._v(t._s(""+(t.investmentAd.text?t.investmentAd.text:"成为书架馆长"))+" ")])]),a("van-col",{attrs:{span:"10"}},["notice"==t.type&&t.notice.length?a("div",{staticClass:"content"},[a("van-swipe",{attrs:{autoplay:5e3,height:60,"indicator-color":"#fff",vertical:"","show-indicators":!1}},t._l(t.list,function(e,i){return a("van-swipe-item",{key:i},t._l(e,function(e,i){return a("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],key:i,staticClass:"notice theme-color",on:{click:function(a){return t.toArticle(e)}}},[t._v("\n                "+t._s(e.details||e.title)+"\n              ")])}),0)}),1)],1):a("div",{staticClass:"content"},[a("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"notice"},[t._v("万册图书触手可及")]),a("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"notice"},[t._v("幼儿园/学校的新名片")])])]),a("van-col",{staticClass:"flex flex-justify",attrs:{span:"7"}},[a("van-button",{staticClass:"theme-btn",attrs:{round:"",size:"small",type:"primary"},on:{click:t.toRegister}},[t._v("注册/办卡")])],1)],1)],1)])},s=[],o=(a("7364"),a("9993")),n=a("bec1"),c={name:"investment",props:["investmentAd","type"],computed:{list:function(){return Object(n["h"])(this.notice,2)}},data:function(){return{isAdshow:!0,count:0,notice:[]}},created:function(){localStorage.getItem("ad")&&(this.isAdshow=JSON.parse(localStorage.getItem("ad"))),this.fetchData()},watch:{isAdshow:function(t){localStorage.setItem("ad",t)},$router:"fetchData"},methods:{hideAd:function(){this.isAdshow=!1},toRegister:function(){this.$router.push({name:"register"})},toArticle:function(t,e){this.$router.push({name:"article",query:{id:t.post_id,type:t.template_id,back:this.$route.name,back_id:this.$route.query.id}})},fetchData:function(){var t=this,e={params:{portal_name:"学校主页",cate:"通知",school_id:this.$route.query.id||""}};o["a"].get("/book/SchoolArticle/getList",e).then(function(e){1==e.data.status&&(t.count=e.data.count,t.notice=e.data.data)})}}},r=c,l=(a("1776"),a("17cc")),h=Object(l["a"])(r,i,s,!1,null,"247569e3",null);e["a"]=h.exports},a009:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"drying-list"},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":t.$store.state.slogan},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[0==t.list.length?a("div",{staticClass:"no-content"},[t._v("\n          尚无内容\n        ")]):t._l(t.list,function(e,i){return a("div",{key:i,staticClass:"item",on:{click:function(a){return t.setItem(e)}}},[a("van-cell",[a("div",{staticClass:"content"},[a("graphic-card",{attrs:{item:e},on:{follow:t.follow,more:t.actionsheet}})],1)])],1)})],2)],1),a("van-action-sheet",{attrs:{actions:t.manageActions,"cancel-text":"取消","get-container":"#app"},on:{select:t.onRecommendSelect},model:{value:t.actionsheetShow,callback:function(e){t.actionsheetShow=e},expression:"actionsheetShow"}}),a("van-action-sheet",{attrs:{actions:t.actions,"cancel-text":"取消","get-container":"#app"},on:{select:t.onSelect,cancel:function(e){t.show=!1}},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}}),a("van-action-sheet",{attrs:{actions:t.reportActions,"cancel-text":"取消","get-container":"#app"},on:{select:t.onReportSelect,cancel:function(e){t.reportShow=!1}},model:{value:t.reportShow,callback:function(e){t.reportShow=e},expression:"reportShow"}})],1)},s=[],o=(a("7364"),a("f763"),a("e20c")),n=a("9993"),c=a("591a"),r=a("77e0"),l=a("5c8c"),h=a("a618"),u={name:"drying-list",mixins:[r["d"]],components:{slogan:l["a"],graphicCard:h["a"]},props:["params","tagId","school_id","type","portal_name","banji_id","cateId"],computed:Object(o["a"])({},Object(c["c"])(["userToken","managerState","userDataState"]),{manage:function(){var t;if(this.managerState)return this.managerState.forEach(function(e){"teacher"==e.item_relation&&(t=!0)}),t},actions:function(){var t=[{name:"推荐",type:"recommend",index:2}];return this.item.isMe?t.push({name:"删除",type:"delete",index:1}):(this.manage&&t.push({name:"删除",type:"delete",index:1}),t.push({name:"举报",type:"report",index:3})),t},reportActions:function(){var t=[];return t.push({name:"垃圾内容",subname:"低俗，标题党等"},{name:"拉黑",subname:"不再推送".concat(this.item?"".concat(this.item.user.name):"他","发布的内容"),is_block:1}),t}}),data:function(){return{postId:"",templateId:"",show:!1,DetailsId:0,pictureShow:!1,praiseShow:!1,actionsheetShow:!1,list:[],item:"",loading:!1,finished:!1,page:1,reportShow:!1}},methods:{getList:function(){var t=this,e={params:Object(o["a"])({page:this.page},this.params,{tag_id:this.tagId,route:this.type,cate_id:this.cid,banji_id:this.banji_id})};return this.school_id&&(e.params.school_id=this.school_id),this.portal_name&&(e.params.portal_name=this.portal_name),this.cateId&&(e.params.cate_id=this.cateId),n["a"].get("/book/SchoolArticle/getList",e).then(function(e){1==e.data.status?(1==t.page?t.list=e.data.data:t.list=t.list.concat(e.data.data),t.page++,t.loading=!1,t.list.length>=e.data.count&&(t.finished=!0)):(t.list=[],t.loading=!1,t.finished=!0)})},onLoad:function(){this.getList()},onRefresh:function(){var t=this;this.page=1,this.getList().then(function(e){t.loading=!1,t.finished=!1})},follow:function(t){this.list.forEach(function(e){e.user_id==t.user_id&&(e.isSubscribe=!e.isSubscribe)}),n["a"].get("/book/MemberFollow/subscribe?user_id=".concat(t.user_id)).then(function(t){})},onSelect:function(t){var e=this;switch(t.index){case 1:this.$dialog.confirm({title:"删除",message:"您确认要删除吗"}).then(function(){var t={params:{id:e.postId}};"apps-school"==e.$route.name&&(t.params.mode="school"),n["a"].get("/book/SchoolArticle/del",t).then(function(t){var a;1==t.data.status?(e.list.forEach(function(t,i){t.post_id==e.postId&&(a=i)}),e.list.splice(a,1),e.$toast.success("删除成功")):e.$toast(t.data.msg)})}).catch(function(){}),this.show=!1;break;case 2:if(this.managerState.length)this.actionsheetShow=!0,"apps-school"==this.$route.name&&this.manageActions.splice(this.manageActions.length-1,1);else{var a={title:"",message:"",routeName:""};switch("0"){case this.userDataState.school_id:a.title="请加入学校",a.message="加入学校，及时了解学校动态",a.routeName="edit-school";break;case this.userDataState.banji_id:a.title="请加入班级",a.message="加入班级，及时了解班级动态",a.routeName="edit-class";break}this.$dialog.confirm({title:a.title,message:a.message,cancelButtonText:"稍后",confirmButtonText:"加入"}).then(function(){e.$router.push({name:a.routeName})}).catch(function(){}),this.show=!1}break;case 3:this.reportShow=!0,this.show=!1;break}},actionsheet:function(t){this.show=!0,this.postId=t.post_id,this.templateId=t.template_id},onReportSelect:function(t){var e=this,a={params:{post_id:this.postId,reason:t.name,is_block:t.is_block?t.is_block:""}};n["a"].get("/book/SchoolArticle/report",a).then(function(t){e.$toast(t.data.msg);var a,i=e.list;i.forEach(function(t,i){e.item.post_id==t.post_id&&(a=i)}),e.list.splice(a,1)}),this.reportShow=!1},setItem:function(t){this.item=t},toggle:function(t){this.$refs.checkboxes[t].toggle()}}},d=u,p=(a("e39b"),a("17cc")),m=Object(p["a"])(d,i,s,!1,null,"4e641841",null);e["a"]=m.exports},aea0:function(t,e,a){},d071:function(t,e,a){"use strict";var i=a("fb28"),s=a.n(i);s.a},e39b:function(t,e,a){"use strict";var i=a("aea0"),s=a.n(i);s.a},fb28:function(t,e,a){}}]);
//# sourceMappingURL=chunk-630f37a0.506a4c4e.js.map