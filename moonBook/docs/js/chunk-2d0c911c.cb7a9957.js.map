{"version":3,"sources":["webpack:///./src/components/pages/special/specialPunch.vue?3233","webpack:///src/components/pages/special/specialPunch.vue","webpack:///./src/components/pages/special/specialPunch.vue?9edb","webpack:///./src/components/pages/special/specialPunch.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","color","line-width","line-height","sticky","swipeable","animated","border","on","change","onChangeTab","_l","list","index","key","title","refresh","onRefresh","model","value","callback","$$v","loading","expression","finished","finished-text","$store","state","slogan","load","onLoad","content","length","item","itemIndex","_v","class","isBtnShow","round","size","type","click","$event","setReleaseSwitch","overlayStyle","backgroundColor","get-container","lock-scroll","show","isShow","iconLength","position","close","staticRenderFns","specialPunchvue_type_script_lang_js_","name","mixins","mixin","components","graphicCard","tips","computed","Object","objectSpread","vuex_esm","classYear","time","date","Date","month","getMonth","year","getFullYear","tab","_this","array","push","level","banjiList","forEach","element","data","formatBanjiTitle","banji_id","get","releaseSwitch","set","val","tabIndex","page","created","_this2","fetchData","$nextTick","watch","$router","methods","_this3","params","school_id","userDataState","teacher_school_id","sort","api","then","res","status","getList","_this4","concat","$forceUpdate","count","_this5","special_specialPunchvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/chunk-2d0c911c.cb7a9957.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"special-punch\"},[_c('van-tabs',{attrs:{\"color\":\"#0084ff\",\"line-width\":20,\"line-height\":4,\"sticky\":\"\",\"swipeable\":\"\",\"animated\":\"\",\"border\":false},on:{\"change\":_vm.onChangeTab}},_vm._l((_vm.tab),function(list,index){return _c('van-tab',{key:index,attrs:{\"title\":list.title}},[_c('van-pull-refresh',{on:{\"refresh\":_vm.onRefresh},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":_vm.$store.state.slogan},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},[(list.content&&list.content.length)?_c('div',{staticClass:\"list\"},_vm._l((list.content),function(item,itemIndex){return _c('div',{key:itemIndex,staticClass:\"item\"},[_c('van-cell',[_c('graphicCard',{attrs:{\"item\":item}})],1)],1)}),0):_c('div',{staticClass:\"no-list\"},[_vm._v(\"\\n                  尚无数据\\n              \")])])],1)],1)}),1),_c('div',{staticClass:\"release-footer-bar\"},[_c('van-button',{staticClass:\"theme-btn\",class:_vm.isBtnShow?'bounceInUp animated':'',attrs:{\"round\":\"\",\"size\":\"normal\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.setReleaseSwitch(true)}}},[_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")]),_vm._v(\"\\n      发布\\n    \")]),_c('van-popup',{staticClass:\"tips-popup\",attrs:{\"overlayStyle\":{backgroundColor:\"transparent\"},\"get-container\":\".footer-bar\",\"lock-scroll\":false},model:{value:(_vm.show),callback:function ($$v) {_vm.show=$$v},expression:\"show\"}},[_c('tips',{attrs:{\"isShow\":_vm.show,\"iconLength\":\"2\",\"position\":\"bottom\"},on:{\"close\":function($event){return _vm.setReleaseSwitch(false)}}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"special-punch\">\r\n    <van-tabs color='#0084ff' :line-width='20' :line-height='4' sticky swipeable animated @change=\"onChangeTab\" :border='false'>\r\n      <van-tab v-for=\"(list,index) in tab\" :key=\"index\" :title='list.title'>\r\n        <van-pull-refresh v-model=\"loading\" @refresh=\"onRefresh\">\r\n            <van-list v-model=\"loading\" :finished=\"finished\" :finished-text=\"$store.state.slogan\" @load=\"onLoad\">\r\n                <div class=\"list\" v-if='list.content&&list.content.length'>\r\n                    <div class=\"item\" v-for='(item,itemIndex) in list.content' :key=\"itemIndex\">\r\n                        <van-cell>\r\n                            <graphicCard :item='item'/>\r\n                        </van-cell>\r\n                    </div>\r\n                </div>\r\n                <div class=\"no-list\" v-else>\r\n                    尚无数据\r\n                </div>\r\n            </van-list>\r\n        </van-pull-refresh>\r\n      </van-tab>\r\n    </van-tabs>\r\n\r\n    <div class=\"release-footer-bar\">\r\n      <van-button class=\"theme-btn\" :class=\"isBtnShow?'bounceInUp animated':''\" round size=\"normal\" type=\"primary\" @click=\"setReleaseSwitch(true)\">\r\n        <i class=\"iconfont\">&#xe664;</i>\r\n        发布\r\n      </van-button>\r\n      <van-popup v-model=\"show\" class=\"tips-popup\" :overlayStyle='{backgroundColor:\"transparent\"}' get-container='.footer-bar' :lock-scroll='false'>\r\n        <tips :isShow='show' iconLength='2' position='bottom' @close='setReleaseSwitch(false)' />\r\n      </van-popup>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from './../../lib/js/api'\r\nimport { mapGetters,mapMutations,mapState } from 'vuex'\r\nimport { format } from './../../lib/js/util'\r\nimport { newBanjiTitle } from './../../lib/js/mixin'\r\nimport graphicCard from './../../module/card/graphicCard'\r\nimport tips from './../../module/release/tips'\r\n\r\nexport default {\r\n  name: 'special-punch',\r\n  mixins: [ newBanjiTitle ],\r\n  components: {\r\n    graphicCard,\r\n    tips\r\n  },\r\n  computed: {\r\n    ...mapGetters(['userDataState']),\r\n    ...mapState(['releaseSwitch']),\r\n    classYear() {\r\n      let date = new Date()\r\n      let month = date.getMonth() + 1\r\n      let year = date.getFullYear()\r\n      let time\r\n\r\n      if (month < 9) {\r\n        time = year - 1\r\n      } else {\r\n        time = year\r\n      }\r\n\r\n      return time\r\n    },\r\n    tab() {\r\n      let array = []\r\n\r\n      array.push({\r\n        title:'推荐',\r\n        level: 1\r\n      },{\r\n        title:'全校',\r\n      })\r\n\r\n      this.banjiList.forEach(element => {\r\n        let data = {\r\n          title: this.formatBanjiTitle(element.title),\r\n          banji_id: element.banji_id\r\n        }\r\n\r\n        array.push(data)\r\n      })\r\n\r\n      return array\r\n    },\r\n    show:{\r\n      get(){\r\n        return this.releaseSwitch\r\n      },\r\n      set(val){\r\n        this.setReleaseSwitch(val)\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      banjiList: [],\r\n      list: [],\r\n      tabIndex: 0,\r\n      loading: false,\r\n      finished: false,\r\n      page:1,\r\n      isBtnShow: true\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchData()\r\n    this.$nextTick(()=>{\r\n      this.isBtnShow = true\r\n    })\r\n  },\r\n  watch: {\r\n    '$router': 'fetchData'\r\n  },\r\n  methods: {\r\n    ...mapMutations(['setReleaseSwitch']),\r\n    fetchData() {\r\n      let data = {\r\n        params: {\r\n          school_id: this.userDataState.school_id || this.userDataState.teacher_school_id,\r\n          year: this.classYear,\r\n          sort: 'post_num'\r\n        }\r\n      }\r\n      axios.get('/book/school_banji/getlist', data).then(res => {\r\n        switch (res.data.status) {\r\n          case 1:\r\n            this.banjiList = res.data.data\r\n            break\r\n        }\r\n      })\r\n    },\r\n    onLoad(){\r\n      this.getList()\r\n    },\r\n    getList(){\r\n        let data = {\r\n            params:{\r\n                banji_id:this.tab[this.tabIndex].banji_id,\r\n                sort:'new',\r\n                level: this.tab[this.tabIndex].level,\r\n                page: this.page\r\n            }\r\n        }       \r\n\r\n        return axios.get('/book/SchoolArticle/getList',data).then(res=>{\r\n            switch(res.data.status){\r\n                case 1:\r\n                    if (this.page == 1) {\r\n                        this.tab[this.tabIndex].content = res.data.data\r\n                    } else {\r\n                        this.tab[this.tabIndex].content = this.tab[this.tabIndex].content.concat(res.data.data)\r\n                    }\r\n\r\n                    this.$forceUpdate()\r\n                    this.page++\r\n                    this.loading = false\r\n                    if (this.tab[this.tabIndex].content >= res.data.count) {\r\n                        this.finished = true\r\n                    }\r\n                break\r\n                case 0:\r\n                    this.tab[this.tabIndex].content = []\r\n                    this.loading = false\r\n                    this.finished = true\r\n                break\r\n            }\r\n        })    \r\n    },\r\n    // formatBanjiTitle(text) {\r\n    //   if (text && text.indexOf('班') == -1) {\r\n    //     return text + '班'\r\n    //   } else {\r\n    //     let arr = text.split('')\r\n    //     let newArr = [...new Set(arr)]\r\n    //     return newArr.join('')\r\n    //   }\r\n    // },\r\n    onRefresh(){\r\n      this.page = 1\r\n      this.getList().then(() => {\r\n        this.loading = false\r\n        this.finished = false\r\n      })\r\n    },\r\n    onChangeTab(index) {\r\n      this.tabIndex = index\r\n      this.page = 1\r\n      this.onRefresh()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/_thread-loader@2.1.2@thread-loader/dist/cjs.js!../../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!./specialPunch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/_thread-loader@2.1.2@thread-loader/dist/cjs.js!../../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!./specialPunch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./specialPunch.vue?vue&type=template&id=190f5e36&scoped=true&\"\nimport script from \"./specialPunch.vue?vue&type=script&lang=js&\"\nexport * from \"./specialPunch.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/_vue-loader@15.7.0@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"190f5e36\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}