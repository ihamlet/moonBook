(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2aba2752"],{3224:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"apps module-card flex flex-align",class:e.type},e._l(e.appsList,function(t,i){return a("div",{key:i,staticClass:"icon",on:{click:function(a){return e.toPage(t)}}},[a("div",{staticClass:"iconfont",class:[t.iconClass,0==i&&"apps-school"==e.$route.name?"rotate":""]}),a("div",{staticClass:"name"},[e._v(e._s(t.name))])])}),0)},n=[],s={name:"apps",props:["appsList","type"],methods:{toPage:function(e){e.routeLink?window.location=e.routeLink:e.params&&this.$router.push({name:e.path,query:e.params})}}},o=s,r=(a("cfb0"),a("2877")),c=Object(r["a"])(o,i,n,!1,null,"096fee60",null);t["a"]=c.exports},"4c70":function(e,t,a){"use strict";var i=a("556c"),n=a.n(i);n.a},"556c":function(e,t,a){},"82d3":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-child"},[a("van-nav-bar",{attrs:{title:e.pageTitle,border:!1,"right-text":2==e.active?"重新注册":""},on:{"click-right":e.renewReg}}),a("van-steps",{attrs:{active:e.active,"active-icon":"success","active-color":"#38f"}},[a("van-step",[e._v("注册申请")]),a("van-step",[e._v("等待审核")]),a("van-step",[e._v("通过")])],1),0==e.active?a("div",{staticClass:"teacher-form"},[a("van-radio-group",[a("div",{staticClass:"form-title"},[e._v("学校设置")]),a("van-cell-group",[a("van-cell",{attrs:{value:"设置",title:e.managerData.school_name,size:"large",label:e.formatBanjiTitle(e.managerData.banji_name),"title-class":"cell-school-title",center:"","is-link":""},on:{click:function(t){return e.toSetting(e.managerData)}}})],1)],1),e.jobList?a("div",{staticClass:"office"},[a("div",{staticClass:"form-title"},[e._v("职位设置")]),a("van-cell-group",[a("van-field",{attrs:{"input-align":"right",label:"职位",readonly:"",placeholder:"班主任"},on:{click:e.selectOffice},model:{value:e.office,callback:function(t){e.office=t},expression:"office"}})],1)],1):e._e(),a("van-popup",{attrs:{position:"bottom","get-container":"#app"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("van-picker",{ref:"officePicker",attrs:{columns:e.jobList,title:"选择职位","show-toolbar":"","visible-item-count":3},on:{change:e.onChange,cancel:e.onClose,confirm:e.onConfirm}}),a("van-field",{attrs:{size:"large",label:"填写职位",placeholder:"职位信息","input-align":"right"},model:{value:e.writeOffice,callback:function(t){e.writeOffice=t},expression:"writeOffice"}})],1)],1):e._e(),1==e.active?a("div",{staticClass:"verify"},[a("van-cell-group",[a("van-cell",{attrs:{title:"提交时间",value:e.getTime(e.managerData.update_time)}}),a("van-cell",{attrs:{title:"学校",label:e.managerData.school_name,center:""}}),e.managerData.banji_name?a("van-cell",{attrs:{title:"班级",label:e.formatBanjiTitle(e.managerData.banji_name)}}):e._e(),a("van-cell",{attrs:{title:"职务",value:e.managerData.duty}})],1)],1):e._e(),2==e.active?a("div",{staticClass:"manage"},[a("apps",{attrs:{appsList:e.appsList}})],1):e._e(),a("div",{staticClass:"footer-bar"},[a("van-button",{staticClass:"theme-btn",attrs:{square:"",type:"primary",size:"large",loading:e.loading},on:{click:e.setStep}},[e._v(e._s(e.btnText))])],1)],1)},n=[],s=(a("7f7f"),a("cebc")),o=a("9993"),r=a("591a"),c=a("bec1"),l=a("77e0"),u=a("3224"),h={name:"teacher",mixins:[l["e"]],components:{apps:u["a"]},computed:Object(s["a"])({},Object(r["c"])(["userDataState","userPointState"]),{jobList:function(){var e=[];return"teacher"==this.$route.query.registerType&&(e=["班主任","带班老师","生活老师"]),"headmaster"==this.$route.query.registerType&&(e=["校长","副校长"]),e},status:function(){var e="";return this.managerData&&(0==this.managerData.is_confirm?e="您的表单需要审核，请等待审核通过...":1==this.managerData.is_confirm?e="表单审核通过":2==this.managerData.is_confirm&&(e="表单审核，被拒绝!")),e},pageTitle:function(){var e;return e="teacher"==this.$route.query.registerType?"老师注册":"校长注册",e}}),data:function(){return{office:"",writeOffice:"",show:!1,submitLoading:!1,managerData:{typecode:"141204",school_name:"",banji_name:"",is_confirm:-1},schoolInfo:"",school:"",active:0,btnText:"下一步",loading:!1,appsList:[{name:"代借还",iconClass:"icon-huanshu",routeLink:"/book/ManageBorrow/borrow"},{name:"定位码",iconClass:"icon-saomadingwei",routeLink:"/book/ManageShelf/location"},{name:"数据",iconClass:"icon-shuju",routeLink:"/SchoolManage/MemberCard"},{name:"权限管理",iconClass:"icon-quanxian",routeLink:"/SchoolManage"},{name:"捐书",iconClass:"icon-shujia",routeLink:"/book/member/entry_donation"}],renew:!0}},created:function(){this.fetchData(),this.office=this.managerData.duty},beforeRouteEnter:function(e,t,a){a(function(e){e.backRouter(t.name)})},watch:{$router:"fetchData",active:function(e){switch(e){case 0:this.btnText="下一步";break;case 1:this.btnText="修改申请";break;case 2:this.btnText="teacher"==this.$route.query.registerType?"前往班级":"前往学校";break}}},methods:{backRouter:function(e){"edit-class"!=e&&"edit-school"!=e||(this.renew=!1)},fetchData:function(){var e,t=this;this.managerData.school_name=this.$route.query.school_name,this.managerData.banji_name=this.$route.query.banji_name,this.managerData.school_id=this.$route.query.school_id,this.managerData.banji_id=this.$route.query.banji_id,"headmaster"==this.$route.query.registerType&&(e={params:{is_master:1}}),o["a"].get("/book/SchoolTeacher/getMine",e).then(function(e){if(e.data.status)if(t.renew)switch(e.data.data.is_confirm){case"0":t.active=1,t.managerData=Object(s["a"])({},e.data.data,t.$route.query);break;case"1":t.active=2;break;case"2":t.active=0;break}else t.active=0})},toSetting:function(){this.$router.push({name:"edit-setting",query:Object(s["a"])({},this.$route.query,{school_name:this.managerData.school_name,school_id:this.managerData.school_id,banji_name:this.formatBanjiTitle(this.managerData.banji_name),banji_id:this.managerData.banji_id})})},selectOffice:function(){this.writeOffice="",this.show=!0},onChange:function(e,t){this.office=t},setStep:function(){var e=this;switch(this.active){case 0:this.loading=!0;var t={params:Object(s["a"])({},this.managerData,this.$route.query)};"headmaster"==this.$route.query.registerType&&(t.params.is_master=1),t.params.duty=this.office,o["a"].get("/book/SchoolTeacher/bind",t).then(function(t){1==t.data.status&&(e.loading=!1,e.active=1,e.renew=!0,e.fetchData())});break;case 1:this.active=0;break;case 2:switch(this.$route.query.registerType){case"teacher":this.$router.push({name:"class-home",query:{id:this.userDataState.teacher_banji_id}});break;case"headmaster":this.$router.push({name:"apps-school",query:{id:this.userDataState.teacher_school_id}});break}break}},toSchool:function(){this.$router.push({name:"apps-school",query:{id:this.managerData.school_id,type:"preview"}})},toBanji:function(){this.$router.push({name:"class-home",query:{id:this.managerData.banji_id,type:"preview"}})},getTime:function(e){return Object(c["d"])(1e3*e,"yyyy-MM-dd")},onClose:function(){this.$refs.officePicker.setColumnValue(0,0),this.show=!1},onConfirm:function(){this.writeOffice&&(this.office=this.writeOffice),this.show=!1},renewReg:function(){var e=this;this.$dialog.alert({message:"您的注册表单已经通过审核，重新注册表单将会重新提交，您确定要重新注册吗？",confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0}).then(function(){e.active=0}).catch(function(){})}}},f=h,m=(a("96b3"),a("4c70"),a("2877")),p=Object(m["a"])(f,i,n,!1,null,"51ccf354",null);t["default"]=p.exports},9699:function(e,t,a){},"96b3":function(e,t,a){"use strict";var i=a("9699"),n=a.n(i);n.a},cece:function(e,t,a){},cfb0:function(e,t,a){"use strict";var i=a("cece"),n=a.n(i);n.a}}]);