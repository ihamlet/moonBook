(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7add29ec"],{"3bc7":function(t,e,a){},"74f6":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.hackReset?a("div",{staticClass:"article page-padding"},[0==t.item.template_id&&t.item.cover?a("div",{staticClass:"cover"},[a("img",{directives:[{name:"http2https",rawName:"v-http2https"}],attrs:{src:t.item.cover}})]):t._e(),a("div",{staticClass:"page-container"},[a("van-nav-bar",{key:t.$route.query.id,class:t.item.cover&&0==t.item.template_id&&!t.themeBarSearch?"theme-nav":"",attrs:{border:!1,fixed:"",zIndex:100}},[a("div",{staticClass:"head-bar-title",attrs:{slot:"title"},slot:"title"},[a("transition",{attrs:{name:"slide-fade",mode:"out-in"}},[t.themeBarSearch?a("div",{key:"2",staticClass:"head-bar-title-conent flex flex-align flex-justify",on:{click:t.toZoom}},[t.item.user?a("div",{staticClass:"avatar"},[a("img",{directives:[{name:"http2https",rawName:"v-http2https"}],attrs:{src:t.item.user.avatar,alt:t.item.user.username},on:{error:t.imgError}})]):t._e(),t.item.user?a("div",{directives:[{name:"line-clamp",rawName:"v-line-clamp:20",value:1,expression:"1",arg:"20"}],staticClass:"name"},[t._v(t._s(t.item.user.username))]):t._e(),t.item.card_level?a("vip-level",{attrs:{animate:"1",level:t.item.card_level.level}}):t._e()],1):a("div",{key:"1",staticClass:"head-bar-title-conent"},[t._v("\n            "+t._s("preview"==t.$route.query.type?"预览":t.$route.meta.title)+"\n          ")])])],1),3!=t.item.isSubscribe?a("div",{staticClass:"head-bar-right",attrs:{slot:"right"},slot:"right"},[a("transition",{attrs:{name:"slide-fade",mode:"out-in"}},[t.themeBarSearch?a("van-button",{staticClass:"theme-btn",attrs:{size:"small",plain:!!t.item.isSubscribe,type:"primary",round:""},on:{click:function(e){return t.follow(t.item)}}},[t._v(t._s(t.item.isSubscribe?"已关注":"关注"))]):t._e()],1)],1):t._e()]),a("div",{staticClass:"container",class:0==t.item.template_id&&t.item.cover?"noTop":""},[a("div",{staticClass:"module-user-card page-padding"},["0"!=t.item.template_id?a("userCard",{attrs:{item:t.item,schoolName:t.$route.query.school_name,schoolId:t.$route.query.school_id}}):t._e()],1),a("div",{staticClass:"module"},[a("article-content",{key:t.$route.query.id,attrs:{item:t.item,isCommentShow:t.isCommentShow},on:{onScrollDomShow:t.onScrollDomShow}}),t.post?a("div",{staticClass:"article-card"},[a("van-cell",[a("articleCard",{key:t.$route.query.id,attrs:{cardStyle:"article",type:t.postType,childId:t.item.child_id,item:t.post,detailsId:t.post.post_id||t.post.tushu_id},on:{toDetails:t.toArticle}})],1)],1):t._e(),a("articleOperation",{attrs:{item:t.item}})],1),a("div",{ref:"commentDom",staticClass:"comment"},[a("comment",{key:t.$route.query.id,attrs:{item:t.item,include:"include",postId:t.item.post_id},on:{showComment:t.onClickisShowComment}})],1)])],1)]):t._e()},s=[],o=(a("34a3"),a("7364"),a("f301"),a("e20c")),n=a("9993"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"article-operation"},[a("div",{staticClass:"btn-warp flex flex-align"},[a("div",{staticClass:"flex-btn"},[a("van-button",{staticClass:"theme-btn tuijian",attrs:{round:"",size:"normal",type:"primary"},on:{click:t.recommend}},[a("i",{staticClass:"iconfont"},[t._v("")]),t._v(" 推荐")])],1),t.isBtnShow?a("div",{staticClass:"flex-btn"},[a("van-button",{staticClass:"theme-btn shoulu",attrs:{round:"",size:"normal",type:"primary"},on:{click:t.selectChildren}},[a("i",{staticClass:"iconfont"},[t._v("")]),t._v("收录")])],1):t._e()]),a("van-popup",{attrs:{position:"bottom","get-container":"#app"},model:{value:t.childShow,callback:function(e){t.childShow=e},expression:"childShow"}},[a("van-picker",{attrs:{"show-toolbar":"","visible-item-count":4,columns:t.children,"value-key":"name",title:"收录到宝贝"},on:{change:t.onChange,confirm:t.selectChild,cancel:function(e){t.childShow=!1}}})],1),a("van-popup",{staticClass:"page-popup-layer",attrs:{position:"bottom","get-container":"#app"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("topic-list",{attrs:{type:"share",topicList:t.topicList},on:{close:function(e){t.show=!1},select:t.selectTag,confirm:t.selectConfirm}})],1),a("van-action-sheet",{attrs:{actions:t.manageActions,"cancel-text":"取消","get-container":"#app"},on:{select:t.onRecommendSelect},model:{value:t.actionsheetShow,callback:function(e){t.actionsheetShow=e},expression:"actionsheetShow"}})],1)},r=[],l=a("ae3a"),h=a("591a"),m=a("77e0"),u={name:"article-operation",mixins:[m["d"]],props:["item"],components:{topicList:l["a"]},computed:Object(o["a"])({},Object(h["c"])(["managerState","userDataState"]),{isBtnShow:function(){var t=!0;return"zoom"!=this.$route.query.back&&"baby-home"!=this.$route.query.back||(t=!1),t}}),data:function(){return{actionsheetShow:!1,topicList:[],cateId:"",children:[],childId:"",show:!1,childShow:!1}},created:function(){this.fetchData()},watch:{$router:"fetchData"},methods:{fetchData:function(){var t=this;if(this.userDataState.user_id){var e={params:{sort:"old",user_id:this.userDataState.user_id}};n["a"].get("/book/baby/getList",e).then(function(e){1==e.data.status&&e.data.data.length&&(t.children=e.data.data,t.childId=e.data.data[0].id)})}else this.$toast("获取用户信息失败");var a={params:{portal_name:"宝贝主页"}};n["a"].get("/book/schoolArticleCate/getList",a).then(function(e){200==e.status&&(t.topicList=e.data,t.cateId=e.data[0].cate_id)})},onChange:function(t,e){this.childId=e.id},selectChild:function(){this.childShow=!1,this.show=!0},selectTag:function(t){this.cateId=t.cate_id},selectConfirm:function(){this.childId,this.cateId;this.$router.push({name:"graphic",query:Object(o["a"])({},this.$route.query,{post_id:this.$route.query.id})}),this.show=!1},recommend:function(){var t=this;if(this.managerState.length)this.actionsheetShow=!0;else{var e={title:"",message:"",routeName:"",query:""};switch("0"){case this.userDataState.school_id:e.title="请加入学校",e.message="加入学校，及时了解学校动态",e.routeName="edit-school",e.query={type:"register"};break;case this.userDataState.banji_id:e.title="请加入班级",e.message="加入班级，及时了解班级动态",e.routeName="edit-class",e.query={school_name:this.userDataState.school_name,school_id:this.userDataState.school_id,name:this.userDataState.child_name,type:"register"};break}this.$dialog.confirm({title:e.title,message:e.message,cancelButtonText:"稍后",confirmButtonText:"加入"}).then(function(){t.$router.push({name:e.routeName,query:e.query})}).catch(function(){})}},selectChildren:function(){var t=this;this.children.length?this.childShow=!0:this.$dialog.confirm({title:"请添加宝贝",message:"添加宝贝，掌握孩子阅读数据，亲子阅读邀请你来参加",cancelButtonText:"稍后",confirmButtonText:"添加"}).then(function(){t.$router.push({name:"edit-child",query:{type:"add"}}),localStorage.removeItem("childInfo")}).catch(function(){})}}},d=u,p=(a("c229"),a("17cc")),f=Object(p["a"])(d,c,r,!1,null,"141ca905",null),v=f.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"article-content",class:["screenshot"==t.type?"img-content":"",0!=t.item.template_id?"flex flex-align":""]},[0==t.item.template_id?a("div",{staticClass:"article-header"},[a("div",{staticClass:"title"},[t._v(t._s(t.item.title))]),a("div",{ref:"domHeight",staticClass:"userCard"},[a("userCard",{attrs:{item:t.item}})],1)]):t._e(),a("article",[a("div",{staticClass:"main"},[a("div",{staticClass:"media-content"},[a("media",{key:t.$route.query.id,attrs:{item:t.item,type:"details",isCommentShow:t.isCommentShow}})],1)])])])},_=[],g=a("f6ba"),w=a("5b8d"),S={name:"article-content",props:["item","type","isCommentShow"],mixins:[m["h"]],components:{media:g["a"],userCard:w["a"]}},y=S,C=(a("d050"),Object(p["a"])(y,b,_,!1,null,"636331f6",null)),k=C.exports,x=a("93c1"),$=a("c629"),q=a("0df1"),D={name:"detailsArticle",components:{media:g["a"],comment:$["a"],vipLevel:q["a"],userCard:w["a"],articleContent:k,articleCard:x["a"],articleOperation:v},computed:Object(o["a"])({},Object(h["e"])(["slogan","logo"]),Object(h["e"])("openWX",["ready"]),Object(h["c"])(["userDataState"]),{post:function(){var t;return t=this.item.extra?JSON.parse(this.item.extra):"",t},postType:function(){var t;return t=this.item.extra?JSON.parse(this.item.extra).type:"",t}}),data:function(){return{themeBarSearch:!1,imageShow:!1,headBar:!1,imgIndex:"",qrImage:"",item:{photos:[]},hackReset:!0,isCommentShow:!1}},beforeRouteLeave:function(t,e,a){var i=["home","apps-find","apps-school","zoom"];i.includes(t.name)?t.meta.keepAlive=!0:t.meta.keepAlive=!1,a()},created:function(){this.fetchData()},updated:function(){this.wxShare()},watch:{$router:"fetchData",ready:function(){this.wxShare()}},methods:Object(o["a"])({},Object(h["b"])("openWX",["share"]),{wxShare:function(){var t={item:this.item,success:function(){console.log("微信分享")}};this.share(t)},fetchData:function(){var t=this;this.$toast.loading();var e={params:{ajax:1,id:this.$route.query.id||this.$route.query.back_id}};n["a"].get("/book/SchoolArticle/detail",e).then(function(e){1==e.data.status&&(t.$toast.clear(),t.item=e.data.data.post)})},onScrollDomShow:function(t){this.themeBarSearch=t},imgError:function(t){t.target.src="https://wx.qlogo.cn/mmopen/ajNVdqHZLLBGT5R0spIjic7Pobf19Uw0qc07mwPLicXILrafUXYkhtMTZ0WialrHiadXDKibJsRTux0WvmNuDyYRWDw/0"},toZoom:function(){this.$router.push({name:"zoom",query:{id:this.item.user_id,back:this.$route.name,back_id:this.$route.query.id}})},follow:function(t){var e=this;t.isSubscribe=!t.isSubscribe;var a={params:{user_id:t.user_id}};n["a"].get("/book/MemberFollow/subscribe",a).then(function(t){e.$toast.success(t.data.msg)})},toArticle:function(t){var e=this;this.hackReset=!1,this.$router.replace({name:t.routeName,query:Object(o["a"])({},this.$route.query,{id:this.post.post_id})}),this.$nextTick(function(){e.hackReset=!0,e.fetchData()})},onClickisShowComment:function(t){this.isCommentShow=t}})},j=D,I=(a("823b"),Object(p["a"])(j,i,s,!1,null,"147a1b16",null));e["default"]=I.exports},"823b":function(t,e,a){"use strict";var i=a("953e"),s=a.n(i);s.a},"953e":function(t,e,a){},b2a8:function(t,e,a){},c229:function(t,e,a){"use strict";var i=a("b2a8"),s=a.n(i);s.a},d050:function(t,e,a){"use strict";var i=a("3bc7"),s=a.n(i);s.a}}]);